<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlumbOS Desktop</title>
    <style>
        :root {
            /* –û—Å–Ω–æ–≤–Ω—ã–µ —Ü–≤–µ—Ç–∞ */
            --purple: #772953;
            --purple-2: #a34d78;
            --purple-3: #c973a1;
            --orange: #e95420;
            --orange-2: #ff6b35;
            --orange-3: #ff8c42;
            --orange-30: rgba(233, 84, 32, 0.3);
            --orange-20: rgba(233, 84, 32, 0.2);
            --orange-10: rgba(233, 84, 32, 0.1);
            --yellow: #ffbd2e;
            --green: #28ca42;
            --dark-1: #2c001e;
            --dark-2: #4a1e35;
            --dark-3: #1a1a1a;
            --white: #ffffff;
            --muted: #cccccc;
            --gray: #614960;
            --offwhite: #f5f5f5;

            /* –û—Ç—Ç–µ–Ω–∫–∏ —Å –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å—é */
            --white-30: rgba(255, 255, 255, 0.3);
            --white-25: rgba(255, 255, 255, 0.25);
            --white-20: rgba(255, 255, 255, 0.2);
            --white-10: rgba(255, 255, 255, 0.1);
            --white-06: rgba(255, 255, 255, 0.06);

            --purple-90: rgba(119, 41, 83, 0.9);
            --orange-90: rgba(233, 84, 32, 0.9);
            --purple-80: rgba(119, 41, 83, 0.8);
            --orange-80: rgba(233, 84, 32, 0.8);

            /* –°–∏–Ω—è—è —Ç–µ–º–∞ */
            --blue-1: #1e3a8a;
            --blue-2: #3b82f6;
            --blue-3: #60a5fa;
            --blue-90: rgba(30, 58, 138, 0.9);
            --blue-80: rgba(59, 130, 246, 0.8);

            /* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ */
            --dark-4: #2a2a2a;
            --dark-90: rgba(26, 26, 26, 0.9);
            --dark-80: rgba(42, 42, 42, 0.8);

            /* –ü—Ä–æ—á–∏–µ */
            --black-50: rgba(0, 0, 0, 0.5);

            /* Launcher (–∫–Ω–æ–ø–∫–∞ –ü—É—Å–∫) - —Ü–≤–µ—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
            --launcher-color-1: var(--orange-2);
            --launcher-color-2: var(--purple);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Ubuntu', Arial, sans-serif;

            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;

        }

        body {
            background: linear-gradient(135deg, var(--purple) 0%, var(--orange) 50%, var(--purple) 100%);
            height: 100vh;
            overflow: hidden;
            color: var(--white);
        }

        /* –ü–∞–Ω–µ–ª—å –∑–∞–¥–∞—á */
        .taskbar {
            background: linear-gradient(90deg, var(--purple-90) 0%, var(--orange-90) 100%);
            height: 46px;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            display: flex;
            align-items: center;
            padding: 0 20px;
            backdrop-filter: blur(10px);
            border-top: 1px solid var(--white-20);
            z-index: 200;
        }

        .app-window.minimized {
            display: none;
        }

        .taskbar-item {
            content: "";
            position: relative;
            /* left: 0;
            right: 0; */
            /* height: 1px; */
            /* pointer-events: none; */
            /* –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –£–¥–∞–ª–µ–Ω –Ω–µ–≤–µ—Ä–Ω—ã–π/–ª–∏—à–Ω–∏–π background */
            /* background: radial-gradient(...) - —É–¥–∞–ª–µ–Ω */
            padding: 5px 10px;
            /* –£–±–∏—Ä–∞–µ–º –ø—Ä–µ–∂–Ω–∏–µ –∂—ë—Å—Ç–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã, –æ–Ω–∏ –±—É–¥—É—Ç —Ä–∏—Å–æ–≤–∞—Ç—å—Å—è –ø—Å–µ–≤–¥–æ—ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ */
            border-top: none;
            border-bottom: none;
            border-left: none;
            margin: 0 5px;
            cursor: pointer;
            font-size: 12px;
            color: var(--white);
            overflow: hidden;
        }

        /* –¢–æ–Ω–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã —Å–≤–µ—Ä—Ö—É/—Å–Ω–∏–∑—É —Å –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–º,
           –Ω–æ —Å —á—É—Ç—å –º–µ–Ω—å—à–µ–π –Ω–µ–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å—é –ø–æ –±–æ–∫–∞–º */
        .taskbar-item::before,
        .taskbar-item::after {
            content: "";
            position: absolute;
            left: 0;
            right: 0;
            height: 1px;
            pointer-events: none;
            background: linear-gradient(90deg,
                    rgba(255, 255, 255, 0.06) 0%,
                    /* –∫—Ä–∞–π ‚Äî –æ—á–µ–Ω—å –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π */
                    rgba(255, 255, 255, 0.65) 50%,
                    /* —Ü–µ–Ω—Ç—Ä –≥—Ä–∞–Ω–∏—Ü—ã ‚Äî –±–æ–ª–µ–µ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–π */
                    rgba(255, 255, 255, 0.06) 100%
                    /* –¥—Ä—É–≥–æ–π –∫—Ä–∞–π */
                );
            opacity: 0.9;
        }

        .taskbar-item::before {
            top: 0;
        }

        .taskbar-item::after {
            bottom: 0;
        }

        .taskbar-item.active {
            background: linear-gradient(90deg,
                    rgba(255, 255, 255, 0.06) 0%,
                    /* –∫—Ä–∞–π ‚Äî –æ—á–µ–Ω—å –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π */
                    rgba(255, 255, 255, 0.65) 50%,
                    /* —Ü–µ–Ω—Ç—Ä –≥—Ä–∞–Ω–∏—Ü—ã ‚Äî –±–æ–ª–µ–µ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–π */
                    rgba(255, 255, 255, 0.06) 100%
                    /* –¥—Ä—É–≥–æ–π –∫—Ä–∞–π */
                );
        }

        .launcher {
            background: linear-gradient(135deg, var(--white-20), var(--white-10));
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            cursor: pointer;
            border: 1.7px solid var(--white-10);
            border-radius: 8px;
            color: var(--dark-2);
            font-weight: bold;
            padding: 4px;
        }

        .launcher svg {
            width: 100%;
            height: 100%;
            display: block;
            color: var(--dark-3);
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.45));
            transform-origin: center center;
            transition: transform 190ms cubic-bezier(.2, .9, .2, 1), filter 140ms ease;
            transition: all 0.3s;

        }

        .launcher:hover svg,
        .launcher:focus svg {
            transform: scale(1.18);
            filter: drop-shadow(0 6px 10px rgba(0, 0, 0, 0.5));
        }

        /* Start (Win) menu */
        .start-menu {
            position: fixed;
            left: 16px;
            bottom: 56px;
            width: 380px;
            max-width: calc(100% - 32px);
            background: linear-gradient(180deg, rgba(20, 12, 18, 0.98), rgba(34, 18, 28, 0.96));
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 12px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.6);
            padding: 14px;
            transform-origin: left bottom;
            transform: translateY(10px) scale(0.98);
            opacity: 0;
            pointer-events: none;
            transition: transform 220ms cubic-bezier(.2, .9, .2, 1), opacity 180ms ease;
            z-index: 10000;
            color: var(--white);
        }

        .start-menu.show {
            opacity: 1;
            transform: translateY(0) scale(1);
            pointer-events: auto;
        }

        .start-menu .search {
            display: flex;
            gap: 8px;
            margin-bottom: 10px;
        }

        .start-menu input[type="search"] {
            flex: 1;
            padding: 8px 10px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.06);
            background: rgba(255, 255, 255, 0.03);
            color: var(--white);
            outline: none;
        }

        .start-menu .apps-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-bottom: 10px;
        }

        .start-menu .app-btn {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            padding: 8px;
            margin: 1px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 6px;
            cursor: pointer;
            font-size: 13px;
            transition: transform 160ms ease, background 160ms ease;
        }

        .start-menu .app-btn:hover {
            transform: translateY(-6px);
            background: rgba(255, 255, 255, 0.04);
        }

        .start-menu .footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 8px;
            margin-top: 6px;
        }

        .start-menu .profile {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .start-menu .power {
            padding: 8px 8px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            cursor: pointer;

        }

        .dock {
            display: flex;
            gap: 10px;
        }

        .dock-item {
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, var(--white-20), var(--white-10));
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid var(--white-10);
            border-radius: 8px;
        }

        .dock-item:hover {
            transform: translateY(-5px);
            background: linear-gradient(135deg, var(--white-30), var(--white-20));
        }

        .dock-item.active {
            background: linear-gradient(135deg, var(--orange), var(--orange-2));
        }

        /* –†–∞–±–æ—á–∏–π —Å—Ç–æ–ª */
        .desktop {
            padding: 20px;
            height: calc(100vh - 40px);
            display: grid;
            grid-template-columns: repeat(auto-fill, 80px);
            grid-auto-rows: 90px;
            gap: 20px;
        }

        .desktop-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 10px;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .desktop-icon:hover {
            background: var(--white-10);
        }

        .icon {
            width: 48px;
            height: 48px;
            border-radius: 10px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .icon-text {
            font-size: 12px;
            text-align: center;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        /* –û–∫–Ω–æ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ */
        .terminal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 600px;
            height: 400px;
            background: linear-gradient(135deg, var(--dark-1) 0%, var(--dark-2) 100%);
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            border: 1px solid var(--white-10);
        }

        .terminal-header {
            background: linear-gradient(90deg, var(--purple), var(--orange));
            height: 30px;
            display: flex;
            align-items: center;
            padding: 0 15px;
            border-bottom: 1px solid var(--white-10);
        }

        .terminal-buttons {
            display: flex;
            gap: 8px;
        }

        .terminal-button {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .close {
            background: #ff5f57;
        }

        .minimize {
            background: var(--yellow);
        }

        .maximize {
            background: var(--green);
        }

        .terminal-body {
            padding: 20px;
            height: calc(100% - 30px);
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: var(--white);
            overflow-y: auto;
            max-height: 370px;
            line-height: 1;
            white-space: pre;
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        .terminal-body::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }

        .terminal-body::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--orange), var(--purple));
            border-radius: 4px;
        }

        .terminal-body::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, var(--orange-2), var(--purple-2));
        }

        .prompt {
            color: var(--orange);
        }

        .command {
            color: var(--white);
        }

        .output {
            color: var(--muted);
            margin-top: 10px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –æ–∫–æ–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π */
        .app-window {
            position: absolute;
            top: 100px;
            left: 100px;
            width: 600px;
            height: 400px;
            background: linear-gradient(135deg, var(--dark-1) 0%, var(--dark-2) 100%);
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            border: 1px solid var(--white-10);
            display: none;
            z-index: 100;
            min-width: 400px;
            min-height: 300px;
        }

        .window-header {
            background: linear-gradient(90deg, var(--purple), var(--orange));
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 15px;
            border-bottom: 1px solid var(--white-10);
            cursor: move;
        }

        .window-buttons {
            display: flex;
            gap: 8px;
        }

        .window-button {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            cursor: pointer;
        }

        .window-close {
            background: #ff5f57;
        }

        .window-minimize {
            background: var(--yellow);
        }

        .window-maximize {
            background: var(--green);
        }

        .window-title {
            font-size: 14px;
            font-weight: bold;
        }

        /* –ê–∫—Ç–∏–≤–Ω–æ–µ –æ–∫–Ω–æ */
        .app-window.active {
            display: block;
        }

        /* –ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞ */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--black-50);
            display: none;
            z-index: 99;
        }

        .overlay.active {
            display: block;
        }

        .setting-item {
            margin: 15px 0;
            padding: 10px;
            background: var(--white-10);
            border-radius: 8px;
        }

        .setting-label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .setting-control {
            width: 100%;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid var(--white-25);
            background: rgba(0, 0, 0, 0.3);
            background-color: var(--dark-2);
            /* –ù–µ –º–µ–Ω—è—Ç—å! */
            color: var(--white);
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .slider {
            flex: 1;
            height: 5px;
            background: var(--white-20);
            border-radius: 3px;
            outline: none;
        }

        .slider-value {
            min-width: 40px;
            text-align: center;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--white-20);
            border-radius: 24px;
            transition: .4s;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background: var(--white);
            border-radius: 50%;
            transition: .4s;
        }

        .toggle-checkbox:checked+.toggle-slider {
            background: linear-gradient(135deg, var(--orange), var(--orange-2));
        }

        .toggle-checkbox:checked+.toggle-slider:before {
            transform: translateX(26px);
        }

        .color-picker {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            background: transparent;
        }

        .button {
            padding: 10px 20px;
            background: linear-gradient(135deg, var(--orange), var(--orange-2));
            border: none;
            border-radius: 8px;
            color: var(--white);
            cursor: pointer;
            margin: 5px;
        }

        .button:hover {
            background: linear-gradient(135deg, var(--orange-2), var(--orange-3));
        }

        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--white-20);
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }

        .tab.active {
            border-bottom: 2px solid var(--orange);
            color: var(--orange);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è */
        .system-info {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            border: 1px solid var(--white-10);
        }

        .clock {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .system-stats {
            font-size: 12px;
            opacity: 0.8;
        }

        .window-content {
            padding: 20px;
            height: calc(100% - 30px);
            color: var(--white);
            overflow-y: auto;
        }

        .window-content::-webkit-scrollbar {
            width: 8px;
        }

        .window-content::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }

        .window-content::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--orange), var(--purple));
            border-radius: 4px;
        }

        .window-content::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, var(--orange-2), var(--purple-2));
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∏–≥—Ä */
        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100%;
        }

        .game-canvas {
            border: 2px solid var(--orange);
            border-radius: 10px;
            background: var(--dark-3);
        }

        .game-controls {
            margin-top: 15px;
            display: flex;
            gap: 10px;
        }

        .game-stats {
            margin-top: 10px;
            font-size: 14px;
            color: var(--muted);
        }

        .game-selector {
            /* display: grid; */
            display: flex;
            justify-content: center;
            align-content: center;
            /* align-items: center; */
            /* vertical-align: middle; */
            /* grid-template-columns: repeat(2, 1fr); */
            gap: 15px;
            margin-top: 20px;
        }

        .game-card {
            background: var(--white-10);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            /* min-width: 180px; */
            /* max-width: 220px; */
            width: 200px;
        }

        .game-card:hover {
            background: var(--white-20);
            transform: translateY(-2px);
        }

        /* –†—É—á–∫–∏ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ */
        .resize-handle {
            position: absolute;
            background: transparent;
            z-index: 10;
        }

        .resize-handle-bottom-right {
            width: 15px;
            height: 15px;
            bottom: 0;
            right: 0;
            cursor: nwse-resize;
        }

        .resize-handle-bottom {
            width: calc(100% - 30px);
            height: 5px;
            bottom: 0;
            left: 15px;
            cursor: ns-resize;
        }

        .resize-handle-right {
            width: 5px;
            height: calc(100% - 30px);
            right: 0;
            top: 15px;
            cursor: ew-resize;
        }

        /* –î–ª—è –æ–∫–æ–Ω —Å –∏–≥—Ä–∞–º–∏ —É–≤–µ–ª–∏—á–∏–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –≤—ã—Å–æ—Ç—É */
        #games-window {
            min-width: 500px;
            min-height: 400px;
        }

        #video-window {
            min-width: 750px;
            min-height: 630px;
        }

        #settings-window {
            min-width: 400px;
            min-height: 410px;
        }

        #browser-window {
            min-width: 700px;
            min-height: 560px;
        }

        #paint-window {
            display: none;
            min-width: 840px;
            min-height: 640px;
            /* min-width: 520px; */
            /* min-height: 360px; */
        }

        #paint-undo,
        #paint-redo {
            font-size: 1.1rem;
            font-style: normal;
        }

        .app-window.maximized {
            border-radius: 0;
            resize: none;
        }

        .app-window.maximized .resize-handle {
            display: none;
        }

        .folder-icon {
            padding: 10px;
            background: var(--white-10);
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .folder-icon:hover {
            background: var(--white-20);
        }

        #notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--orange);
            padding: 10px 20px;
            border-radius: 5px;
            display: none;
            z-index: 1000;
            color: var(--white);
            font-weight: bold;
        }

        .pong-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100%;
            justify-content: center;
        }

        #pong-canvas {
            border: 2px solid var(--orange);
            border-radius: 10px;
            background: var(--dark-3);
        }


        .pong-controls {
            margin-top: 15px;
            display: flex;
            gap: 10px;
        }

        .pong-stats {
            margin-top: 10px;
            font-size: 14px;
            color: var(--muted);
            text-align: center;
        }

        .pong-instructions {
            margin-top: 10px;
            font-size: 12px;
            color: var(--offwhite);
            text-align: center;
        }

        .ascii-logo {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.15);
            white-space: pre;
            z-index: -1;
            pointer-events: none;
            text-align: center;
            line-height: 1.2;
            font-weight: bold;
            text-shadow:
                0 0 10px var(--orange-30),
                0 0 20px var(--orange-20),
                0 0 30px var(--orange-10);
            user-select: none;
            filter: contrast(1.2);
        }

        .toggle-checkbox {
            width: 0px;
            height: 0px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞ */
        .browser-toolbar {
            background: linear-gradient(90deg, var(--purple-80), var(--orange-80));
            padding: 10px 15px;
            border-bottom: 1px solid var(--white-10);
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .browser-nav-buttons {
            display: flex;
            gap: 5px;
        }

        .browser-nav-btn {
            width: 32px;
            height: 32px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            color: var(--white);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.2s ease;
        }

        .browser-nav-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .browser-nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .browser-address-bar {
            flex: 1;
            display: flex;
            gap: 5px;
            align-items: center;
            min-width: 200px;
        }

        .browser-address-input {
            flex: 1;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            color: var(--white);
            font-size: 12px;
        }

        .browser-address-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .browser-address-input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.25);
            border-color: #e95420;
        }

        .browser-search-btn {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--orange), var(--orange-2));
            border: none;
            border-radius: 6px;
            color: var(--white);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .browser-search-btn:hover {
            background: linear-gradient(135deg, #ff6b35, #ff8c42);
        }

        .browser-body {
            padding: 0;
            height: calc(100% - 60px);
            overflow: hidden;
            background: #2c001e;
            user-select: all;
        }

        .browser-content {
            width: 100%;
            height: 100%;
            background: var(--white);
            color: #333;
            overflow: auto;
        }

        .browser-content iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .browser-home-page {
            padding: 40px 20px;
            text-align: center;
            /* background: linear-gradient(135deg, var(--offwhite) 0%, var(--white) 100%); */
            background: linear-gradient(135deg, var(--dark-1) 0%, var(--dark-2) 100%);
            /* color: var(--white); */
            height: 100%;
            overflow-y: auto;
        }

        .browser-home-logo {
            font-size: 48px;
            margin-bottom: 20px;
        }

        .browser-home-title {
            font-size: 28px;
            color: var(--muted);
            margin-bottom: 10px;
            font-weight: bold;
        }

        .browser-home-subtitle {
            font-size: 16px;
            color: var(--muted);
            margin-bottom: 40px;
        }

        .browser-quicklinks {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        .browser-quicklink {
            background: var(--white);
            border: 2px solid var(--orange);
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: #333;
        }

        .browser-quicklink:hover {
            background: var(--orange);
            color: var(--white);
            transform: translateY(-5px);
        }

        .browser-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            font-size: 18px;
            color: var(--gray);
        }

        .browser-loading::after {
            content: '';
            width: 20px;
            height: 20px;
            margin-left: 10px;
            border: 3px solid #e95420;
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* –ú–µ–Ω—é —Ñ–∞–π–ª–∞ (—Ç—Ä–æ–µ—Ç–æ—á–∏–µ) */
        .item-container {
            position: relative;
        }

        .menu-button {
            position: absolute;
            top: 6px;
            right: 6px;
            width: 28px;
            height: 28px;
            border-radius: 6px;
            /* background: rgba(0,0,0,0.25); */
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 16px;
        }

        .menu-button:hover {
            background: rgba(255, 255, 255, 0.06);
        }

        .file-menu {
            position: absolute;
            top: 38px;
            right: 6px;
            background: linear-gradient(135deg, var(--dark-1) 0%, var(--dark-2) 100%);
            border: 1px solid var(--white-06);
            border-radius: 6px;
            padding: 6px 0;
            min-width: 140px;
            z-index: 130;
            display: none;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.6);
        }

        .file-menu button {
            width: 100%;
            background: transparent;
            border: none;
            color: var(--white);
            padding: 8px 12px;
            text-align: left;
            cursor: pointer;
            font-size: 13px;
        }

        .file-menu button:hover {
            background: rgba(255, 255, 255, 0.03);
        }

        .calc-buttons .button {
            text-shadow:
                -0.6px -0.6px 0 #000,
                0.6px -0.6px 0 #000,
                -0.6px 0.6px 0 #000,
                0.6px 0.6px 0 #000;
            font-size: 16px;
            border: 1px solid var(--gray);
            border-radius: 0.8vh;

        }

        #calculator-window {
            overflow: hidden;
            height: auto;
        }

        .taskbarr {
            display: flex;
            height: 80%;
            padding-top: 5px;
            /* padding-bottom: 5px; */
        }

        /* Paint styles */
        .paint-toolbar {
            display: flex;
            gap: 10px;
            align-items: center;
            padding: 10px;
            background: linear-gradient(90deg, var(--purple-80), var(--orange-80));
            border-bottom: 1px solid var(--white-10);
            min-height: 48px;
            color: var(--white);
            flex-wrap: wrap;
        }

        .paint-canvas-wrap {
            padding: 12px;
            /* background: var(--black-50); */
            height: calc(100% - 62px);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .paint-canvas {
            background: var(--dark-3);
            border: 2px #131314 solid;
            border-radius: 6px;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.4);
        }

        .paint-tool-btn {
            padding: 8px 10px;
            border-radius: 6px;
            border: none;
            background: rgba(255, 255, 255, 0.06);
            color: var(--white);
            cursor: pointer;
        }

        .paint-tool-btn.active {
            background: linear-gradient(135deg, var(--orange), var(--orange-2));
        }

        .power-btn {
            padding: 0;
            margin: 0;
            width: 20px;
            height: 20px;
            cursor: pointer;
            transition: transform 0.3s ease, filter 0.3s ease;
            filter: drop-shadow(0 0 5px rgba(128, 128, 128, 0.3));
        }

        .power-btn:hover {
            transform: scale(1.1);
            filter: drop-shadow(0 0 10px rgb(36, 36, 36));
        }

        /* –¶–≤–µ—Ç SVG –∏–∫–æ–Ω–∫–∏ */
        .power-icon {
            margin: 0;
            padding: 0;
            fill: none;
            stroke: #808080;
            /* –°–µ—Ä—ã–π —Ü–≤–µ—Ç */
            stroke-width: 2;
            stroke-linecap: round;
        }
    </style>
</head>

<body>
    <!-- –†–∞–±–æ—á–∏–π —Å—Ç–æ–ª -->
    <div class="desktop">
        <div class="desktop-icon" onclick="openApp('files')">
            <div class="icon" style="background: linear-gradient(135deg, var(--orange), var(--orange-2));">
                <img src="./res/folder.png" width="55%" height="55%" alt="">
            </div>
            <div class="icon-text">–§–∞–π–ª—ã</div>
        </div>
        <div class="desktop-icon" onclick="openApp('browser')">
            <div class="icon" style="background: linear-gradient(135deg, var(--purple), var(--purple-2));">
                <img src="./res/browser.png" width="60%" height="60% alt="">
            </div>
            <div class=" icon-text">–ë—Ä–∞—É–∑–µ—Ä
            </div>
        </div>
        <div class="desktop-icon" onclick="openApp('games')">
            <div class="icon" style="background: linear-gradient(135deg, var(--orange-2), var(--orange-3));">
                <img src="./res/games.png" width="60%" height="60% alt="">
            </div>
            <div class=" icon-text">–ò–≥—Ä—ã
            </div>
        </div>
        <div class="desktop-icon" onclick="openApp('settings')">
            <div class="icon" style="background: linear-gradient(135deg, var(--purple-2), var(--purple-3));">
                <img src="./res/settings.png" width="60%" height="60% alt="">
            </div>
            <div class=" icon-text">–ù–∞—Å—Ç—Ä–æ–π–∫–∏
            </div>
        </div>
        <div class="desktop-icon" onclick="openNotepad()">
            <div class="icon"
                style="background: linear-gradient(135deg, var(--white-20), var(--white-10)); color: #333">
                <img src="./res/notepad-1.png" width="55%" height="55% alt="">
            </div>
            <div class=" icon-text">–ë–ª–æ–∫–Ω–æ—Ç
            </div>
        </div>
        <div class="desktop-icon" onclick="openApp('paint')">
            <div class="icon" style="background: linear-gradient(135deg, var(--orange-2), var(--orange-3));">
                <img src="./res/paint-1.png" width="55%" height="55% alt="">
            </div>
            <div class=" icon-text">Paint
            </div>
        </div>
    </div>

    <!-- –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
    <div class="system-info">
        <div class="clock" id="clock">14:30:25</div>
        <div class="system-stats">
            <div>CPU: 24% | RAM: 3.2/8GB</div>
            <div>BlumbOS 22.04 LTS</div>
        </div>
    </div>

    <!-- –ü–∞–Ω–µ–ª—å –∑–∞–¥–∞—á -->
    <div class="taskbar">
        <button class="launcher" onclick="toggleStartMenu(event)">
            <svg viewBox="-143 145 512 512" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
                <defs>
                    <linearGradient id="launcher-grad" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="var(--launcher-color-1)" />
                        <stop offset="100%" stop-color="var(--launcher-color-2)" />
                    </linearGradient>
                </defs>
                <g fill="currentColor">
                    <path
                        d="M76.6,488.2c4.9-16.5,21.4-72.9,24.5-83.7c-3.5-2.2-7.1-4.4-10.9-6.5c-8.8-4.5-21.1-9.2-34.6-9.2c-1.5,0-3.1,0.1-4.6,0.2
        c-13.5,1.1-25.8,4.6-34.5,7.6c-2.5,0.9-5.2,1.9-7.9,3L-15,481.8c17.9-7.2,32.4-10.1,44.5-10.1C49.6,471.7,63.5,479.5,76.6,488.2z" />
                    <path d="M115.3,414.9l-23.6,82c0,0,27.6,17,48.4,17c13.1,0,28.8-3.2,48.5-11.3l22.8-79.6c-17.3,6.2-32.2,8.5-44.7,8.5
        C139.1,431.6,122.5,420.7,115.3,414.9z" />
                    <path d="M60.1,369.1c19.2,0.2,32.8,7.9,45.5,16.3c4.8-16.4,19.2-65.8,24.1-82.5v-0.1c0,0-17-10.2-28.8-13.2
        c-5.6-1.3-12-2.2-19.1-2.2c-0.1,0-0.2,0-0.3,0c-12,0.2-26.4,3.1-44.1,10.4l-23.3,82c18.2-7.4,32.9-10.7,45.3-10.7
        C59.6,369.1,59.8,369.1,60.1,369.1z" />
                    <path d="M120.9,396.5c13.2,8.8,30.3,15.9,50.9,15.9c13.6,0,28.8-3.1,45.4-10.9v-0.1c0,0,0.1,0,0.2-0.1L241,320
        c-17.4,7.6-32.7,10.4-45.8,10.4c-26,0-43.1-11-50.6-16.9l-23.9,82.8C120.7,396.3,120.8,396.4,120.9,396.5z" />
                </g>
            </svg>
        </button>
        <!-- Start menu -->
        <div id="start-menu" class="start-menu" aria-hidden="true">
            <div class="search">
                <input type="search" id="start-search" placeholder="–ü–æ–∏—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π...">
                <!-- <button onclick="closeStartMenu()" title="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button> -->
            </div>
            <div class="apps-grid">
                <div class="app-btn" onclick="openApp('files')">üìÅ<div>–§–∞–π–ª—ã</div>
                </div>
                <div class="app-btn" onclick="openApp('browser')">üåê<div>–ë—Ä–∞—É–∑–µ—Ä</div>
                </div>
                <div class="app-btn" onclick="openApp('terminal')">üíª<div>–¢–µ—Ä–º–∏–Ω–∞–ª</div>
                </div>
                <div class="app-btn" onclick="openApp('games')">üéÆ<div>–ò–≥—Ä—ã</div>
                </div>
                <div class="app-btn" onclick="openApp('settings')">‚öôÔ∏è<div>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
                </div>
                <div class="app-btn" onclick="openNotepad()">üìù<div>–ë–ª–æ–∫–Ω–æ—Ç</div>
                </div>
                <div class="app-btn" onclick="openApp('calculator')">üßÆ<div>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</div>
                </div>
                <div class="app-btn" onclick="openApp('video')">üéµ<div>–ú–µ–¥–∏–∞</div>
                </div>
                <div class="app-btn" onclick="openApp('paint')">üé®<div>Paint</div>
                </div>
            </div>
            <div class="footer">
                <div class="profile">
                    <div
                        style="display: flex; justify-content: center; align-items: center; width:36px; height:36px; border-radius:8px; background:var(--white-06);">
                        <img src="./res/user-prifile.svg" width="50%" height="50%" alt="">
                    </div>
                    <div>–ì–æ—Å—Ç—å</div>
                </div>
                <a href="./exit.html">
                    <div style="width: 36px; height: 36px;" class="power">
                        <svg class="power-btn" viewBox="0 0 24 24" onclick="location.reload()" title="–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å">
                            <path class="power-icon" d="M18.36 6.64a9 9 0 1 1-12.73 0M12 2v10" />
                        </svg>
                    </div>
                </a>
            </div>
        </div>
        <div class="dock">
            <div class="dock-item" onclick="openApp('files')">
                <img src="./res/folder.png" width="55%" height="55%" alt="">
            </div>
            <div class="dock-item" onclick="openApp('browser')">
                <img src="./res/browser.png" width="60%" height="60% alt="">
            </div>
            <div class="dock-item" onclick="openApp('terminal')">
                <img src="./res/terminal.png" width="75%" height="75% alt="">
            </div>
            <div class="dock-item" onclick="openApp('calculator')">
                <img src="./res/calculator-2.png" width="60%" height="60% alt="">
            </div>
            <div class="dock-item" onclick="openApp('video')">
                <img src="./res/videoplayer.png" width="70%" height="70% alt="">
            </div>
            <div class="dock-item" onclick="showNotification('–ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ –µ—â–µ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω')">
                <img src="./res/translator.svg" width="70%" height="70% alt="">
            </div>
            <div class="taskbarr" id="taskbar-apps"></div>
        </div>
    </div>

    <!-- –û–∫–Ω–æ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ -->
    <div class="terminal app-window" id="terminal-window">
        <div class="window-header terminal-header">
            <div class="window-buttons">
                <div class="window-button window-close"></div>
                <div class="window-button window-minimize"></div>
                <div class="window-button window-maximize"></div>
            </div>
            <div class="window-title">–¢–µ—Ä–º–∏–Ω–∞–ª</div>
            <div style="width: 60px;"></div>
        </div>
        <div class="terminal-body">
            <div>BlumbOS Terminal v2.1.4</div>
            <div class="output">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ BlumbOS!</div>
            <br>
            <div>
                <span class="prompt">user@blumbos:~$</span>
                <span class="command"> neofetch</span>
            </div>
            <div class="output">
                <pre style="font-family: 'Courier New', monospace; font-size: 12px; line-height: 1;">
        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó     ‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
        ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù
        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ñà‚ñà‚ñà‚ñà‚ïî‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
        ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïë
        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë ‚ïö‚ïê‚ïù ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë
        ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

        OS: BlumbOS 22.04 LTS
        Kernel: 5.15.0-blumbos
        Shell: blumbash 5.1.16
        DE: BlumbGNOME 42.5
        CPU: AMD Ryzen 7 5800X (16) @ 3.800GHz
        GPU: NVIDIA GeForce RTX 3080
        Memory: 3245MiB / 15985MiB

        by Teplishchev M. Isip-205

        (–µ—Å—Ç—å –Ω–µ–¥–æ—Ä–∞–±–æ—Ç–∫–∏, –ø—Ä–æ—à—É –ø–æ–Ω—è—Ç—å –∏ –ø—Ä–æ—Å—Ç–∏—Ç—å)
                </pre>
            </div>

            <div>
                <span class="prompt">user@blumbos:~$</span>
                <span class="command"> ls -la</span>
            </div>
            <div class="output">
                total 64<br>
                drwxr-xr-x 18 user user 4096 Dec 10 14:30 .<br>
                drwxr-xr-x 3 root root 4096 Nov 15 09:20 ..<br>
                -rw------- 1 user user 1256 Dec 9 16:45 .bash_history<br>
                drwxr-xr-x 2 user user 4096 Dec 8 11:15 Documents<br>
                drwxr-xr-x 2 user user 4096 Dec 7 14:20 Downloads<br>
                drwxr-xr-x 2 user user 4096 Dec 6 10:35 Music<br>
                drwxr-xr-x 2 user user 4096 Dec 5 13:45 Pictures<br>
            </div>

            <div>
                <span class="prompt">user@blumbos:~$</span>
                <span class="command"> ps aux | grep blumb</span>
            </div>
            <div class="output">
                user 12547 0.3 1.2 2156784 198452 ? SLl 14:25 0:45 /usr/bin/blumb-shell<br>
                user 12589 0.1 0.8 1123456 132456 ? SLl 14:25 0:23 /usr/lib/blumbos/blumb-service<br>
                user 12634 0.0 0.3 891234 56789 ? S 14:26 0:05 blumb-daemon --start<br>
            </div>

            <div>
                <span class="prompt">user@blumbos:~$</span>
                <span class="command"> df -h</span>
            </div>
            <div class="output">
                Filesystem Size Used Avail Use% Mounted on<br>
                /dev/sda1 467G 156G 288G 36% /<br>
                /dev/sda2 1.9T 856G 952G 48% /home<br>
                tmpfs 16G 2.1G 14G 14% /tmp<br>
            </div>

            <div>
                <span class="prompt">user@blumbos:~$</span>
                <span class="command"> _</span>
            </div>
        </div>
        <div class="resize-handle resize-handle-top"></div>
        <div class="resize-handle resize-handle-top-left"></div>
        <div class="resize-handle resize-handle-top-right"></div>
        <div class="resize-handle resize-handle-bottom"></div>
        <div class="resize-handle resize-handle-right"></div>
        <div class="resize-handle resize-handle-bottom-right"></div>
        <div class="resize-handle resize-handle-left"></div>
    </div>

    <!-- –û–∫–Ω–æ —Ñ–∞–π–ª–æ–≤–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ -->
    <div class="app-window" id="files-window">
        <div class="window-header">
            <div class="window-buttons">
                <div class="window-button window-close" onclick="closeApp('files')"></div>
                <div class="window-button window-minimize" onclick="minimizeApp('files')"></div>
                <div class="window-button window-maximize" onclick="toggleMaximize('files')"></div>
            </div>
            <div class="window-title">–§–∞–π–ª–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä</div>
            <div style="width: 60px;"></div>
        </div>
        <div class="window-content">
            <h3 id="files-title">–î–æ–º–∞—à–Ω—è—è –ø–∞–ø–∫–∞</h3>

            <div id="files-toolbar" style="display:flex; gap:8px; margin-top:10px;">
                <button class="button" id="btn-new-folder">–ù–æ–≤–∞—è –ø–∞–ø–∫–∞</button>
                <button class="button" id="btn-new-file">–ù–æ–≤—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª</button>
                <button class="button" id="btn-up" style="background: var(--gray)">–ù–∞–∑–∞–¥</button>
            </div>

            <div id="files-root"
                style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 20px;"></div>

            <!-- (notepad moved to top-level) -->
        </div>
        <div class="resize-handle resize-handle-top"></div>
        <div class="resize-handle resize-handle-top-left"></div>
        <div class="resize-handle resize-handle-top-right"></div>
        <div class="resize-handle resize-handle-bottom"></div>
        <div class="resize-handle resize-handle-right"></div>
        <div class="resize-handle resize-handle-bottom-right"></div>
        <div class="resize-handle resize-handle-left"></div>
    </div>

    <!-- –û–∫–Ω–æ –ë–ª–æ–∫–Ω–æ—Ç–∞ (–æ—Ç–¥–µ–ª—å–Ω–æ–µ —Ç–æ–ø-—É—Ä–æ–≤–Ω–µ–≤–æ–µ –æ–∫–Ω–æ) -->
    <div class="app-window" id="notepad-window" style="display:none;">
        <div class="window-header">
            <div class="window-buttons">
                <div class="window-button window-close"></div>
                <div class="window-button window-minimize"></div>
                <div class="window-button window-maximize"></div>
            </div>
            <div class="window-title">–ë–ª–æ–∫–Ω–æ—Ç</div>
            <div style="width: 60px;"></div>
        </div>
        <div class="window-content" style="display:flex; flex-direction:column; height:calc(100% - 30px); padding:0;">
            <div
                style="display:flex; justify-content:space-between; align-items:center; padding:10px 14px; background: linear-gradient(135deg, var(--dark-1) 0%, var(--dark-2) 100%); border-bottom:1px solid var(--white-06);">
                <div id="editor-filename" style="font-weight:bold; color:var(--white)">–ù–æ–≤—ã–π —Ñ–∞–π–ª.txt</div>
                <div>
                    <button class="button" id="editor-save">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button class="button" id="editor-close" style="background: var(--gray)">–ó–∞–∫—Ä—ã—Ç—å</button>
                </div>
            </div>
            <textarea id="editor-text"
                style="outline: none; flex:1; width:100%; padding:12px; border:none; resize:none; background:var(--dark-3); color:var(--white); font-family: monospace; font-size:14px;"></textarea>
        </div>
        <div class="resize-handle resize-handle-top"></div>
        <div class="resize-handle resize-handle-top-left"></div>
        <div class="resize-handle resize-handle-top-right"></div>
        <div class="resize-handle resize-handle-bottom"></div>
        <div class="resize-handle resize-handle-right"></div>
        <div class="resize-handle resize-handle-bottom-right"></div>
        <div class="resize-handle resize-handle-left"></div>
    </div>

    <!-- –û–∫–Ω–æ Paint -->
    <div class="app-window" id="paint-window">
        <div class="window-header">
            <div class="window-buttons">
                <div class="window-button window-close" onclick="closeApp('paint')"></div>
                <div class="window-button window-minimize" onclick="minimizeApp('paint')"></div>
                <div class="window-button window-maximize" onclick="toggleMaximize('paint')"></div>
            </div>
            <div class="window-title">Paint</div>
            <div style="width: 60px;"></div>
        </div>
        <div class="window-content" style="padding:0; display:flex; flex-direction:column; height:calc(100% - 30px);">
            <div class="paint-toolbar">
                <button class="paint-tool-btn" id="paint-undo" title="–û—Ç–º–µ–Ω–∏—Ç—å (Ctrl+Z)">‚Üê</button>
                <button class="paint-tool-btn" id="paint-redo" title="–ü–æ–≤—Ç–æ—Ä (Ctrl+Y)">‚Üí</button>
                <input type="color" id="paint-color" title="–í—ã–±–æ—Ä —Ü–≤–µ—Ç–∞" value="#fff">
                <label style="color:var(--white)">–†–∞–∑–º–µ—Ä: <input id="paint-size" type="range" min="1" max="80" value="6"
                        style="vertical-align:middle"></label>
                <button class="paint-tool-btn active" id="paint-brush-normal" data-type="normal">–ö–∏—Å—Ç—å</button>
                <button class="paint-tool-btn" id="paint-brush-soft" data-type="soft">–ú—è–≥–∫–∞—è</button>
                <button class="paint-tool-btn" id="paint-eraser">–õ–∞—Å—Ç–∏–∫</button>
                <button class="paint-tool-btn" id="paint-fill">–ó–∞–ª–∏–≤–∫–∞</button>
                <button class="paint-tool-btn" id="paint-clear">–û—á–∏—Å—Ç–∏—Ç—å</button>
                <button class="paint-tool-btn" id="paint-save">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ Pictures</button>
            </div>
            <div class="paint-canvas-wrap">
                <canvas id="paint-canvas" class="paint-canvas" width="800" height="480"></canvas>
            </div>
        </div>
        <div class="resize-handle resize-handle-top"></div>
        <div class="resize-handle resize-handle-top-left"></div>
        <div class="resize-handle resize-handle-top-right"></div>
        <div class="resize-handle resize-handle-bottom"></div>
        <div class="resize-handle resize-handle-right"></div>
        <div class="resize-handle resize-handle-bottom-right"></div>
        <div class="resize-handle resize-handle-left"></div>
    </div>

    <!-- –û–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞ -->
    <div class="app-window" id="browser-window">
        <div class="window-header">
            <div class="window-buttons">
                <div class="window-button window-close" onclick="closeApp('browser')"></div>
                <div class="window-button window-minimize" onclick="minimizeApp('browser')"></div>
                <div class="window-button window-maximize" onclick="toggleMaximize('browser')"></div>
            </div>
            <div class="window-title">BlumbBrowser</div>
            <div style="width: 60px;"></div>
        </div>

        <!-- –ë—Ä–∞—É–∑–µ—Ä —Ç—É–ª–±–∞—Ä -->
        <div class="browser-toolbar">
            <div class="browser-nav-buttons">
                <button class="browser-nav-btn" id="browser-back" onclick="browserNavigateBack()"
                    title="–ù–∞–∑–∞–¥">‚Üê</button>
                <button class="browser-nav-btn" id="browser-forward" onclick="browserNavigateForward()"
                    title="–í–ø–µ—Ä–µ–¥">‚Üí</button>
                <button class="browser-nav-btn" onclick="browserReload()" title="–û–±–Ω–æ–≤–∏—Ç—å">‚ü≥</button>
                <button class="browser-nav-btn" onclick="browserHome()" title="–ù–∞ –≥–ª–∞–≤–Ω—É—é">üè†</button>
            </div>
            <div class="browser-address-bar">
                <input type="text" class="browser-address-input" id="browser-address"
                    placeholder="–í–≤–µ–¥–∏—Ç–µ URL –∏–ª–∏ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å..."
                    onkeypress="if(event.key === 'Enter') browserNavigate()">
                <button class="browser-search-btn" onclick="browserNavigate()" title="–ü–µ—Ä–µ–π—Ç–∏">üîç</button>
            </div>
        </div>

        <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –±—Ä–∞—É–∑–µ—Ä–∞ -->
        <div class="browser-body">
            <div id="browser-content" class="browser-content">
                <div class="browser-home-page" id="browser-home">
                    <div class="browser-home-logo">üåê</div>
                    <h1 class="browser-home-title">BlumbBrowser</h1>
                    <p class="browser-home-subtitle">–í–≤–µ–¥–∏—Ç–µ URL –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–∏—Å–∫</p>
                    <div class="browser-quicklinks">
                        <a href="javascript:void(0)" onclick="browserNavigateTo('https://github.com')"
                            class="browser-quicklink">
                            <div style="font-size: 24px; margin-bottom: 10px;">üíª</div>
                            <div>GitHub</div>
                        </a>
                        <a href="javascript:void(0)" onclick="browserNavigateTo('https://stackoverflow.com')"
                            class="browser-quicklink">
                            <div style="font-size: 24px; margin-bottom: 10px;">üìö</div>
                            <div>Stack Overflow</div>
                        </a>
                        <a href="javascript:void(0)" onclick="browserNavigateTo('https://www.wikipedia.org')"
                            class="browser-quicklink">
                            <div style="font-size: 24px; margin-bottom: 10px;">üìñ</div>
                            <div>Wikipedia</div>
                        </a>
                        <a href="javascript:void(0)" onclick="browserNavigateTo('https://developer.mozilla.org')"
                            class="browser-quicklink">
                            <div style="font-size: 24px; margin-bottom: 10px;">üéì</div>
                            <div>MDN Docs</div>
                        </a>
                        <a href="javascript:void(0)" onclick="browserNavigateTo('https://youtube.com')"
                            class="browser-quicklink">
                            <div style="font-size: 24px; margin-bottom: 10px;">üì∫</div>
                            <div>YouTube</div>
                        </a>
                        <a href="javascript:void(0)" onclick="browserNavigateTo('https://reddit.com')"
                            class="browser-quicklink">
                            <div style="font-size: 24px; margin-bottom: 10px;">üí¨</div>
                            <div>Reddit</div>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="resize-handle resize-handle-top"></div>
        <div class="resize-handle resize-handle-top-left"></div>
        <div class="resize-handle resize-handle-top-right"></div>
        <div class="resize-handle resize-handle-bottom"></div>
        <div class="resize-handle resize-handle-right"></div>
        <div class="resize-handle resize-handle-bottom-right"></div>
        <div class="resize-handle resize-handle-left"></div>
    </div>

    <!-- –û–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
    <div class="app-window" id="settings-window">
        <div class="window-header">
            <div class="window-buttons">
                <div class="window-button window-close" onclick="closeApp('settings')"></div>
                <div class="window-button window-minimize" onclick="minimizeApp('settings')"></div>
                <div class="window-button window-maximize" onclick="toggleMaximize('settings')"></div>
            </div>
            <div class="window-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ BlumbOS</div>
            <div style="width: 60px;"></div>
        </div>
        <div class="window-content">
            <div class="tabs">
                <div class="tab active" onclick="switchTab('system-tab', event)">–°–∏—Å—Ç–µ–º–∞</div>
                <div class="tab" onclick="switchTab('appearance-tab', event)">–í–Ω–µ—à–Ω–∏–π –≤–∏–¥</div>
                <div class="tab" onclick="switchTab('network-tab', event)">–°–µ—Ç—å</div>
            </div>

            <div id="system-tab" class="tab-content active">
                <h3>–°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h3>

                <div class="setting-item">
                    <label class="setting-label">–Ø–∑—ã–∫ —Å–∏—Å—Ç–µ–º—ã</label>
                    <select class="setting-control" onchange="changeLanguage(this.value)">
                        <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                        <option value="en">English</option>
                        <option value="es">Espa√±ol</option>
                    </select>
                </div>

                <div class="setting-item">
                    <label class="setting-label">–†–∞—Å–∫–ª–∞–¥–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã</label>
                    <select class="setting-control">
                        <option>–†—É—Å—Å–∫–∞—è</option>
                        <option>–ê–Ω–≥–ª–∏–π—Å–∫–∞—è (US)</option>
                    </select>
                </div>

                <div class="setting-item">
                    <label class="setting-label">–ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞</label>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <label class="toggle-switch">
                            <input type="checkbox" class="toggle-checkbox" onchange="toggleAutostart(this.checked)">
                            <span class="toggle-slider"></span>
                        </label>
                        <span>–ó–∞–ø—É—Å–∫–∞—Ç—å BlumbOS –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏</span>
                    </div>
                </div>

                <div class="setting-item">
                    <label class="setting-label">–û–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã</label>
                    <button class="button" onclick="checkUpdates()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</button>
                    <div id="update-status" style="margin-top: 10px; font-size: 12px;"></div>
                </div>
            </div>

            <div id="appearance-tab" class="tab-content">
                <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞</h3>

                <div class="setting-item">
                    <label class="setting-label">–¶–≤–µ—Ç–æ–≤–∞—è —Ç–µ–º–∞</label>
                    <select class="setting-control" onchange="changeTheme(this.value)">
                        <option value="orange">–û—Ä–∞–Ω–∂–µ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç</option>
                        <option value="purple">–§–∏–æ–ª–µ—Ç–æ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç</option>
                        <option value="blue">–°–∏–Ω–∏–π –≥—Ä–∞–¥–∏–µ–Ω—Ç</option>
                        <option value="dark">–¢–µ–º–Ω–∞—è</option>
                    </select>
                </div>

                <div class="setting-item">
                    <label class="setting-label">–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –æ–∫–æ–Ω</label>
                    <div class="slider-container">
                        <input type="range" min="0" max="100" value="80" class="slider"
                            oninput="updateTransparency(this.value)">
                        <span class="slider-value" id="transparency-value">80%</span>
                    </div>
                </div>

                <div class="setting-item">
                    <label class="setting-label">–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞</label>
                    <div class="slider-container">
                        <input type="range" min="12" max="24" value="16" class="slider"
                            oninput="updateFontSize(this.value)">
                        <span class="slider-value" id="fontsize-value">16px</span>
                    </div>
                </div>

                <div class="setting-item">
                    <label class="setting-label">–ê–Ω–∏–º–∞—Ü–∏–∏</label>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <label class="toggle-switch">
                            <input type="checkbox" class="toggle-checkbox" checked
                                onchange="toggleAnimations(this.checked)">
                            <span class="toggle-slider"></span>
                        </label>
                        <span>–í–∫–ª—é—á–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</span>
                    </div>
                </div>
            </div>

            <div id="network-tab" class="tab-content">
                <h3>–°–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h3>

                <div class="setting-item">
                    <label class="setting-label">Wi-Fi –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ</label>
                    <select class="setting-control">
                        <option>BlumbOS-Network (–ø–æ–¥–∫–ª—é—á–µ–Ω–æ)</option>
                        <option>Guest-WiFi</option>
                        <option>Office-Network</option>
                    </select>
                </div>

                <div class="setting-item">
                    <label class="setting-label">–°–∫–æ—Ä–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞</label>
                    <button class="button" onclick="testSpeed()">–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å</button>
                    <div id="speed-result" style="margin-top: 10px; font-size: 12px;"></div>
                </div>

                <div class="setting-item">
                    <label class="setting-label">VPN</label>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <label class="toggle-switch">
                            <input type="checkbox" class="toggle-checkbox" onchange="toggleVPN(this.checked)">
                            <span class="toggle-slider"></span>
                        </label>
                        <span>–í–∫–ª—é—á–∏—Ç—å VPN —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ</span>
                    </div>
                </div>

                <div class="setting-item">
                    <label class="setting-label">–°–µ—Ç–µ–≤–æ–π –º–æ–Ω–∏—Ç–æ—Ä</label>
                    <button class="button" onclick="showNetworkInfo()">–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
                    <div id="network-info" style="margin-top: 10px; font-size: 12px;"></div>
                </div>
            </div>
        </div>
        <div class="resize-handle resize-handle-top"></div>
        <div class="resize-handle resize-handle-top-left"></div>
        <div class="resize-handle resize-handle-top-right"></div>
        <div class="resize-handle resize-handle-bottom"></div>
        <div class="resize-handle resize-handle-right"></div>
        <div class="resize-handle resize-handle-bottom-right"></div>
        <div class="resize-handle resize-handle-left"></div>
    </div>

    <!-- –û–∫–Ω–æ –∏–≥—Ä -->
    <div class="app-window" id="games-window">
        <div class="window-header">
            <div class="window-buttons">
                <div class="window-button window-close" onclick="closeApp('games')"></div>
                <div class="window-button window-minimize" onclick="minimizeApp('games')"></div>
                <div class="window-button window-maximize" onclick="toggleMaximize('games')"></div>
            </div>
            <div class="window-title">–ò–≥—Ä—ã BlumbOS</div>
            <div style="width: 60px;"></div>
        </div>
        <div style="padding-top: 10%; padding-bottom: 5%;" class="window-content">
            <div id="games-menu">
                <div class="game-selector">
                    <h3 style="padding: 0; margin: 0; position: fixed; top: 3.6rem;">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É</h3>
                    <div class="game-card" onclick="startGame('snake')">
                        <div style="font-size: 32px;">üêç</div>
                        <div>–ó–º–µ–π–∫–∞</div>
                    </div>
                    <div class="game-card" onclick="startGame('tetris')">
                        <div style="font-size: 32px;">üßä</div>
                        <div>–¢–µ—Ç—Ä–∏—Å</div>
                    </div>
                </div>
                <div class="game-selector">
                    <div class="game-card" onclick="startGame('pong')">
                        <div style="font-size: 32px;">üéæ</div>
                        <div>–ü–æ–Ω–≥</div>
                    </div>
                    <div class="game-card" onclick="startGame('minesweeper')">
                        <div style="font-size: 32px;">üí£</div>
                        <div>–°–∞–ø–µ—Ä</div>
                    </div>
                </div>
            </div>

            <div id="snake-game" class="game-container" style="display: none;">
                <canvas id="snake-canvas" width="400" height="400" class="game-canvas"></canvas>
                <div class="game-stats">
                    –°—á–µ—Ç: <span id="snake-score">0</span> |
                    –£—Ä–æ–≤–µ–Ω—å: <span id="snake-level">1</span>
                </div>
                <div class="game-controls">
                    <button class="button" onclick="snakePause()">–ü–∞—É–∑–∞</button>
                    <button class="button" onclick="restartGame('snake')">–ó–∞–Ω–æ–≤–æ</button>
                    <button class="button" onclick="showGamesMenu()">–ú–µ–Ω—é</button>
                </div>
            </div>

            <div id="tetris-game" class="game-container" style="display: none;">
                <canvas id="tetris-canvas" width="300" height="600" class="game-canvas"></canvas>
                <div class="game-stats">
                    –°—á–µ—Ç: <span id="tetris-score">0</span> |
                    –õ–∏–Ω–∏–∏: <span id="tetris-lines">0</span>
                </div>
                <div class="game-controls">
                    <button class="button" onclick="tetrisPause()">–ü–∞—É–∑–∞</button>
                    <button class="button" onclick="restartGame('tetris')">–ó–∞–Ω–æ–≤–æ</button>
                    <button class="button" onclick="showGamesMenu()">–ú–µ–Ω—é</button>
                </div>
            </div>
            <div id="pong-game" class="pong-container" style="display: none;">
                <canvas id="pong-canvas" width="600" height="400" class="game-canvas"></canvas>
                <div class="pong-stats">
                    –ò–≥—Ä–æ–∫ 1: <span id="pong-score1">0</span> |
                    –ò–≥—Ä–æ–∫ 2: <span id="pong-score2">0</span>
                </div>
                <div class="pong-instructions">
                    –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –ò–≥—Ä–æ–∫ 1 (W/S), –ò–≥—Ä–æ–∫ 2 (‚Üë/‚Üì) | –ü–∞—É–∑–∞: –ü—Ä–æ–±–µ–ª
                </div>
                <div class="pong-controls">
                    <button class="button" onclick="pausePong()">–ü–∞—É–∑–∞</button>
                    <button class="button" onclick="restartGame('pong')">–ó–∞–Ω–æ–≤–æ</button>
                    <button class="button" onclick="showGamesMenu()">–ú–µ–Ω—é</button>
                </div>
            </div>
            <div id="minesweeper-game" class="game-container"
                style="display:none; flex-direction:column; align-items:center; justify-content:center;">
                <div style="margin-bottom:10px; display:flex; gap:10px; align-items:center;">
                    <span>–ú–∏–Ω: <span id="minesweeper-mine-count">10</span></span>
                    <button class="button" onclick="restartGame('minesweeper')"><img
                            src="./res/refresh-button-svgrepo-com.svg" width="18rem" height="18rem" alt=""></button>
                    <span>–í—Ä–µ–º—è: <span id="minesweeper-timer">0</span> —Å–µ–∫</span>
                </div>
                <div id="minesweeper-board" style="display:inline-block;"></div>
                <div id="minesweeper-status"
                    style="margin-top:10px; font-size:16px; color:var(--orange); font-weight:bold;"></div>
                <div class="game-controls" style="margin-top:10px;">
                    <button class="button" onclick="showGamesMenu()">–ú–µ–Ω—é</button>
                </div>
            </div>
        </div>
        <div class="resize-handle resize-handle-top"></div>
        <div class="resize-handle resize-handle-top-left"></div>
        <div class="resize-handle resize-handle-top-right"></div>
        <div class="resize-handle resize-handle-bottom"></div>
        <div class="resize-handle resize-handle-right"></div>
        <div class="resize-handle resize-handle-bottom-right"></div>
        <div class="resize-handle resize-handle-left"></div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <!-- –û–∫–Ω–æ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ -->
    <div class="app-window" id="calculator-window">
        <div class="window-header">
            <div class="window-buttons">
                <div class="window-button window-close" onclick="closeApp('calculator')"></div>
                <div class="window-button window-minimize" onclick="minimizeApp('calculator')"></div>
                <div class="window-button window-maximize" onclick="toggleMaximize('calculator')"></div>
            </div>
            <div class="window-title">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</div>
            <div style="width: 60px;"></div>
        </div>
        <div class="window-content"
            style="display:flex; flex-direction:column; align-items:center; gap:12px; padding:18px;">
            <div id="calc" style="width:320px;">
                <input id="calc-display" type="text" readonly
                    style="width:100%; height:52px; font-size:20px; text-align:right; padding:10px; border-radius:8px; border:none; background:var(--dark-3); color:var(--white); box-shadow: inset 0 2px 6px rgba(0,0,0,0.6);">

                <div class="calc-buttons"
                    style="display:grid; grid-template-columns: repeat(4, 1fr); gap:8px; margin-top:12px;">
                    <button class="button" data-cmd="clear">C</button>
                    <button class="button" data-cmd="back">‚å´</button>
                    <button class="button" data-cmd="%">%</button>
                    <button class="button" data-cmd="/">√∑</button>

                    <button class="button" data-cmd="7">7</button>
                    <button class="button" data-cmd="8">8</button>
                    <button class="button" data-cmd="9">9</button>
                    <button class="button" data-cmd="*">√ó</button>

                    <button class="button" data-cmd="4">4</button>
                    <button class="button" data-cmd="5">5</button>
                    <button class="button" data-cmd="6">6</button>
                    <button class="button" data-cmd="-">‚àí</button>

                    <button class="button" data-cmd="1">1</button>
                    <button class="button" data-cmd="2">2</button>
                    <button class="button" data-cmd="3">3</button>
                    <button class="button" data-cmd="+">+</button>

                    <button class="button" data-cmd="0" style="grid-column: span 2;">0</button>
                    <button class="button" data-cmd=".">.</button>
                    <button class="button" data-cmd="=">=</button>
                </div>
            </div>
            <div style="display:flex; gap:8px; width:320px; justify-content:flex-end;">
                <!-- <button class="button" onclick="showGamesMenu()" style="background:var(--gray)">–ú–µ–Ω—é –∏–≥—Ä</button> -->
                <!-- <button class="button" onclick="closeApp('calculator')" style="background:var(--gray)">–ó–∞–∫—Ä—ã—Ç—å</button> -->
            </div>
        </div>
        <div class="resize-handle resize-handle-top"></div>
        <div class="resize-handle resize-handle-top-left"></div>
        <div class="resize-handle resize-handle-top-right"></div>
        <div class="resize-handle resize-handle-bottom"></div>
        <div class="resize-handle resize-handle-right"></div>
        <div class="resize-handle resize-handle-bottom-right"></div>
        <div class="resize-handle resize-handle-left"></div>
    </div>

    <!-- –û–∫–Ω–æ –≤–∏–¥–µ–æ–ø–ª–µ–µ—Ä–∞ -->
    <div class="app-window" id="video-window">
        <div class="window-header">
            <div class="window-buttons">
                <div class="window-button window-close" onclick="closeApp('video')"></div>
                <div class="window-button window-minimize" onclick="minimizeApp('video')"></div>
                <div class="window-button window-maximize" onclick="toggleMaximize('video')"></div>
            </div>
            <div class="window-title">–í–∏–¥–µ–æ –ø–ª–µ–µ—Ä</div>
            <div style="width: 60px;"></div>
        </div>
        <div class="window-content" style="display:flex; flex-direction:column; gap:10px;">
            <video id="video-player" class="game-canvas" width="100%" height="360" controls></video>

            <div style="display:flex; gap:8px; align-items:center;">
                <input type="file" id="video-file-input" accept="video/*" />
                <input type="text" id="video-url-input" placeholder="URL –∏–ª–∏ ./video/–∏–º—è_—Ñ–∞–π–ª–∞.mp4"
                    style="flex:1; padding:6px; border-radius:6px; border:1px solid rgba(255,255,255,0.08); background:transparent; color:var(--white);" />
                <button class="button" id="video-load-url-btn">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                <button class="button" id="video-scan-btn">–°–∫–∞–Ω ./video/</button>
            </div>

            <div>
                <strong>–ü–ª–µ–π–ª–∏—Å—Ç:</strong>
                <ul id="video-playlist"
                    style="list-style:none; padding:6px 0; margin:8px 0; max-height:140px; overflow:auto;"></ul>
            </div>
        </div>
        <div class="resize-handle resize-handle-top"></div>
        <div class="resize-handle resize-handle-top-left"></div>
        <div class="resize-handle resize-handle-top-right"></div>
        <div class="resize-handle resize-handle-bottom"></div>
        <div class="resize-handle resize-handle-right"></div>
        <div class="resize-handle resize-handle-bottom-right"></div>
        <div class="resize-handle resize-handle-left"></div>
    </div>

    <div id="notification">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</div>

    <!-- [–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø] –ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞ -->
    <!-- <div class="overlay" id="overlay" onclick="closeAllApps()"></div> -->
    <script>

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
        function getCSSVar(varName) {
            return getComputedStyle(document.documentElement).getPropertyValue(`--${varName}`).trim();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
        function updateClock() {
            const now = new Date();
            const timeString = now.toLocaleTimeString();
            document.getElementById('clock').textContent = timeString;
        }

        setInterval(updateClock, 1000);
        updateClock();

        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.display = 'block';
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // Start menu handling
        function toggleStartMenu(e) {
            const menu = document.getElementById('start-menu');
            if (!menu) return;
            if (menu.classList.contains('show')) {
                closeStartMenu();
            } else {
                openStartMenu();
                const input = document.getElementById('start-search');
                if (input) setTimeout(() => input.focus(), 60);
            }
            if (e && e.stopPropagation) e.stopPropagation();
        }

        function openStartMenu() {
            const menu = document.getElementById('start-menu');
            if (!menu) return;
            menu.classList.add('show');
            menu.setAttribute('aria-hidden', 'false');
        }

        function closeStartMenu() {
            const menu = document.getElementById('start-menu');
            if (!menu) return;
            menu.classList.remove('show');
            menu.setAttribute('aria-hidden', 'true');
            const input = document.getElementById('start-search');
            if (input) input.value = '';
            // restore all app buttons
            document.querySelectorAll('#start-menu .app-btn').forEach(b => b.style.display = 'flex');
        }

        // –ó–∞–∫—Ä—ã–≤–∞—Ç—å –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
        document.addEventListener('click', (e) => {
            if (!e.target.closest('#start-menu') && !e.target.closest('.launcher')) {
                closeStartMenu();
            }
        });

        // Esc –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –º–µ–Ω—é
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeStartMenu();
        });

        // –ü—Ä–æ—Å—Ç–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤ –º–µ–Ω—é
        const startSearch = document.getElementById('start-search');
        if (startSearch) {
            startSearch.addEventListener('input', function () {
                const q = this.value.trim().toLowerCase();
                document.querySelectorAll('#start-menu .app-btn').forEach(b => {
                    const txt = (b.textContent || '').toLowerCase();
                    b.style.display = txt.includes(q) ? 'flex' : 'none';
                });
            });
        }

        // –õ–æ–≥–∏–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è/–∑–∞–∫—Ä—ã—Ç–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
        let openWindows = [];
        let minimizedWindows = [];
        // –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–∫–æ–Ω (left, top, width, height)
        let windowStates = {};
        let currentGame = null;
        let snakeGame = null;
        let tetrisGame = null;
        let pongGame = null;
        let paintInitialized = false;
        let paintUndoStack = [];
        let paintRedoStack = [];
        const PAINT_UNDO_LIMIT = 50;

        function pushPaintState() {
            const canvas = document.getElementById('paint-canvas');
            if (!canvas) return;
            try {
                const data = canvas.toDataURL('image/png');
                const last = paintUndoStack.length ? paintUndoStack[paintUndoStack.length - 1] : null;
                if (last === data) return; // –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
                paintUndoStack.push(data);
                if (paintUndoStack.length > PAINT_UNDO_LIMIT) paintUndoStack.shift();
                // –æ—á–∏—Å—Ç–∏–º redo –ø—Ä–∏ –Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏
                paintRedoStack = [];
                updatePaintUndoRedoButtons();
            } catch (e) { console.error('pushPaintState error', e); }
        }

        function restorePaintState(dataURL) {
            const canvas = document.getElementById('paint-canvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            const img = new Image();
            img.onload = function () {
                canvas.width = Math.max(400, img.naturalWidth);
                canvas.height = Math.max(300, img.naturalHeight);
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img, 0, 0, img.naturalWidth, img.naturalHeight);
            };
            img.src = dataURL;
        }

        function undoPaint() {
            if (paintUndoStack.length === 0) return;
            const canvas = document.getElementById('paint-canvas');
            if (!canvas) return;
            try {
                const current = canvas.toDataURL('image/png');
                const prev = paintUndoStack.pop();
                paintRedoStack.push(current);
                restorePaintState(prev);
                updatePaintUndoRedoButtons();
            } catch (e) { console.error('undoPaint', e); }
        }

        function redoPaint() {
            if (paintRedoStack.length === 0) return;
            const canvas = document.getElementById('paint-canvas');
            if (!canvas) return;
            try {
                const current = canvas.toDataURL('image/png');
                const next = paintRedoStack.pop();
                paintUndoStack.push(current);
                restorePaintState(next);
                updatePaintUndoRedoButtons();
            } catch (e) { console.error('redoPaint', e); }
        }

        function updatePaintUndoRedoButtons() {
            const btnU = document.getElementById('paint-undo');
            const btnR = document.getElementById('paint-redo');
            if (btnU) btnU.disabled = paintUndoStack.length === 0;
            if (btnR) btnR.disabled = paintRedoStack.length === 0;
        }

        function openApp(appName) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –æ–∫–Ω–∞
            const appWindow = document.getElementById(appName + '-window');
            if (!appWindow) {
                showNotification(`–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ "${appName}" –µ—â–µ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ!`);
                return;
            }

            // –ï—Å–ª–∏ –æ–∫–Ω–æ —É–∂–µ –æ—Ç–∫—Ä—ã—Ç–æ –∏ –Ω–µ —Å–≤–µ—Ä–Ω—É—Ç–æ ‚Äî –Ω–µ —Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –µ–≥–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ,
            // –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç–æ –ø–æ–¥–Ω—è—Ç—å –Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏–π –ø–ª–∞–Ω.
            if (appWindow.classList.contains('active') && !appWindow.classList.contains('minimized')) {
                try {
                    const allWins = document.querySelectorAll('.app-window, .terminal');
                    let maxZ = 100;
                    allWins.forEach(w => {
                        const z = parseInt(getComputedStyle(w).zIndex) || 0;
                        if (z > maxZ) maxZ = z;
                    });
                    appWindow.style.zIndex = (maxZ + 1);
                } catch (e) { }
                return;
            }

            // [–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø] const overlay = document.getElementById('overlay');

            if (appWindow) {
                appWindow.classList.add('active');
                // [–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø] overlay.classList.add('active');

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–∫–Ω–æ; –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –µ—Å–ª–∏ –µ—Å—Ç—å
                appWindow.style.display = 'block';
                const state = windowStates[appName];
                if (state) {
                    appWindow.style.left = state.left;
                    appWindow.style.top = state.top;
                    appWindow.style.width = state.width;
                    appWindow.style.height = state.height;
                    appWindow.style.transform = 'none';
                } else {
                    // –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –æ–∫–Ω–æ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
                    appWindow.style.left = '50%';
                    appWindow.style.top = '50%';
                    appWindow.style.transform = 'translate(-50%, -50%)';
                }

                // –ü–æ–¥–Ω—è—Ç—å –æ–∫–Ω–æ –Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏–π –ø–ª–∞–Ω (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞–∏–≤—ã—Å—à–∏–π z-index)
                try {
                    const allWins = document.querySelectorAll('.app-window, .terminal');
                    let maxZ = 100;
                    allWins.forEach(w => {
                        const z = parseInt(getComputedStyle(w).zIndex) || 0;
                        if (z > maxZ) maxZ = z;
                    });
                    appWindow.style.zIndex = (maxZ + 1);
                } catch (e) { }

                // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–æ–∫ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –æ–∫–æ–Ω
                if (!openWindows.includes(appName)) {
                    openWindows.push(appName);
                }

                // –£–±–∏—Ä–∞–µ–º –∏–∑ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –µ—Å–ª–∏ —Ç–∞–º –±—ã–ª
                minimizedWindows = minimizedWindows.filter(app => app !== appName);

                updateTaskbar();
                // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã–ª–∏ —Ñ–∞–π–ª–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä ‚Äî —Ä–µ–Ω–¥–µ—Ä–∏–º —Ç–µ–∫—É—â—É—é –ø–∞–ø–∫—É
                if (appName === 'files') {
                    renderCurrentFolder();
                }
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Paint –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
                if (appName === 'paint') {
                    setTimeout(() => { try { initPaint(); } catch (e) { console.error(e); } }, 80);
                }
            }
        }

        function closeApp(appName) {
            const appWindow = document.getElementById(appName + '-window');
            // [–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø] const overlay = document.getElementById('overlay');

            if (appName === 'games' && currentGame) {
                if (currentGame === 'snake' && snakeGame) {
                    snakeGame.stop();
                } else if (currentGame === 'tetris' && tetrisGame) {
                    tetrisGame.stop();
                } else if (currentGame === 'pong' && pongGame) {
                    pongGame.stop();
                }
                currentGame = null;
            }

            if (appWindow) {
                appWindow.classList.remove('active');
            }

            // –£–±–∏—Ä–∞–µ–º –∏–∑ –≤—Å–µ—Ö —Å–ø–∏—Å–∫–æ–≤
            openWindows = openWindows.filter(app => app !== appName);
            minimizedWindows = minimizedWindows.filter(app => app !== appName);

            updateTaskbar();

            // [–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø] –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –µ—â–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –æ–∫–Ω–∞
            // [–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø] const openWindowsList = document.querySelectorAll('.app-window.active');
            // [–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø] if (openWindowsList.length === 0) {
            // [–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø]     overlay.classList.remove('active');
            // [–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø] }
        }

        function closeAllApps() {
            const appWindows = document.querySelectorAll('.app-window');
            // [–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø] const overlay = document.getElementById('overlay');

            appWindows.forEach(window => {
                window.classList.remove('active');
            });

            openWindows = [];
            minimizedWindows = [];
            updateTaskbar();
            // [–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø] overlay.classList.remove('active');
        }

        // –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–∫–Ω–∞–º–∏
        function minimizeApp(appName) {
            const appWindow = document.getElementById(appName + '-window');
            if (appWindow) {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–ø–æ–∑–∏—Ü–∏—é –∏ —Ä–∞–∑–º–µ—Ä) –µ—Å–ª–∏ –µ—â—ë –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ
                if (!windowStates[appName]) {
                    const rect = appWindow.getBoundingClientRect();
                    const parent = appWindow.offsetParent ? appWindow.offsetParent.getBoundingClientRect() : { left: 0, top: 0 };
                    const leftPx = (rect.left - parent.left) + 'px';
                    const topPx = (rect.top - parent.top) + 'px';
                    const widthPx = rect.width + 'px';
                    const heightPx = rect.height + 'px';
                    windowStates[appName] = { left: leftPx, top: topPx, width: widthPx, height: heightPx };
                }

                appWindow.classList.add('minimized');
                appWindow.classList.remove('active');

                // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–æ–∫ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö
                if (!minimizedWindows.includes(appName)) {
                    minimizedWindows.push(appName);
                }

                updateTaskbar();
            }
        }

        function restoreApp(appName) {
            const appWindow = document.getElementById(appName + '-window');
            if (appWindow) {
                appWindow.classList.remove('minimized');
                appWindow.classList.add('active');

                // –£–±–∏—Ä–∞–µ–º –∏–∑ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö
                minimizedWindows = minimizedWindows.filter(app => app !== appName);

                // –ü–æ–¥–Ω—è—Ç—å –æ–∫–Ω–æ –Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏–π –ø–ª–∞–Ω –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏
                try {
                    const allWins = document.querySelectorAll('.app-window, .terminal');
                    let maxZ = 100;
                    allWins.forEach(w => {
                        const z = parseInt(getComputedStyle(w).zIndex) || 0;
                        if (z > maxZ) maxZ = z;
                    });
                    appWindow.style.zIndex = (maxZ + 1);
                } catch (e) { }

                updateTaskbar();
            }
        }

        function toggleMaximize(appName) {
            const appWindow = document.getElementById(appName + '-window');
            if (appWindow) {
                if (appWindow.classList.contains('maximized')) {
                    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞–∑–º–µ—Ä
                    appWindow.classList.remove('maximized');
                    appWindow.style.width = '600px';
                    appWindow.style.height = '400px';
                    appWindow.style.transform = 'translate(-50%, -50%)';
                } else {
                    // –ú–∞–∫—Å–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å
                    appWindow.classList.add('maximized');
                    appWindow.style.width = 'calc(100% - 40px)';
                    appWindow.style.height = 'calc(100% - 80px)';
                    appWindow.style.top = '20px';
                    appWindow.style.left = '20px';
                    appWindow.style.transform = 'none';
                }
            }
        }

        function updateTaskbar() {
            const taskbar = document.getElementById('taskbar-apps');
            taskbar.innerHTML = '';

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –æ–∫–Ω–∞ (–∫—Ä–æ–º–µ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö)
            openWindows.forEach(appName => {
                if (!minimizedWindows.includes(appName)) {
                    const taskbarItem = document.createElement('div');
                    taskbarItem.className = 'taskbar-item active';
                    taskbarItem.textContent = getAppName(appName);
                    taskbarItem.onclick = () => restoreApp(appName);
                    taskbar.appendChild(taskbarItem);
                }
            });

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–∫–Ω–∞
            minimizedWindows.forEach(appName => {
                const taskbarItem = document.createElement('div');
                taskbarItem.className = 'taskbar-item';
                taskbarItem.textContent = getAppName(appName);
                taskbarItem.onclick = () => restoreApp(appName);
                taskbar.appendChild(taskbarItem);
            });
        }

        function getAppName(appKey) {
            const appNames = {
                'files': '–§–∞–π–ª—ã',
                'browser': '–ë—Ä–∞—É–∑–µ—Ä',
                'games': '–ò–≥—Ä—ã',
                'settings': '–ù–∞—Å—Ç—Ä–æ–π–∫–∏',
                'terminal': '–¢–µ—Ä–º–∏–Ω–∞–ª'
            };
            return appNames[appKey] || appKey;
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
        function switchTab(tabName, event) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });

            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–æ –≤—Å–µ—Ö —Ç–∞–±–æ–≤
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.getElementById(tabName).classList.add('active');

            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ç–∞–±
            event.target.classList.add('active');
        }

        function changeLanguage(lang) {
            localStorage.setItem('blumbos-lang', lang);
            applyLanguage(lang);
            showNotification(`–Ø–∑—ã–∫ –∏–∑–º–µ–Ω–µ–Ω –Ω–∞: ${lang === 'ru' ? '–†—É—Å—Å–∫–∏–π' : lang === 'en' ? 'English' : 'Espa√±ol'}`);
        }

        // –ü–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        const translations = {
            ru: {
                system: '–°–∏—Å—Ç–µ–º–∞',
                appearance: '–í–Ω–µ—à–Ω–∏–π –≤–∏–¥',
                network: '–°–µ—Ç—å',
                systemSettings: '–°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏',
                language: '–Ø–∑—ã–∫ —Å–∏—Å—Ç–µ–º—ã',
                keyboard: '–†–∞—Å–∫–ª–∞–¥–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã',
                keyboardRu: '–†—É—Å—Å–∫–∞—è',
                keyboardEn: '–ê–Ω–≥–ª–∏–π—Å–∫–∞—è (US)',
                autostart: '–ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞',
                autostartDesc: '–ó–∞–ø—É—Å–∫–∞—Ç—å BlumbOS –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏',
                updates: '–û–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã',
                checkUpdates: '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è',
                appearanceSettings: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞',
                theme: '–¶–≤–µ—Ç–æ–≤–∞—è —Ç–µ–º–∞',
                orange: '–û—Ä–∞–Ω–∂–µ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç',
                purple: '–§–∏–æ–ª–µ—Ç–æ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç',
                blue: '–°–∏–Ω–∏–π –≥—Ä–∞–¥–∏–µ–Ω—Ç',
                dark: '–¢–µ–º–Ω–∞—è',
                transparency: '–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –æ–∫–æ–Ω',
                fontSize: '–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞',
                animations: '–ê–Ω–∏–º–∞—Ü–∏–∏',
                enableAnimations: '–í–∫–ª—é—á–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞',
                networkSettings: '–°–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏',
                wifi: 'Wi-Fi –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ',
                speed: '–°–∫–æ—Ä–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞',
                testSpeed: '–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å',
                vpn: 'VPN',
                enableVPN: '–í–∫–ª—é—á–∏—Ç—å VPN —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ',
                netMonitor: '–°–µ—Ç–µ–≤–æ–π –º–æ–Ω–∏—Ç–æ—Ä',
                showStats: '–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É',
                files: '–§–∞–π–ª—ã',
                browser: '–ë—Ä–∞—É–∑–µ—Ä',
                games: '–ò–≥—Ä—ã',
                settings: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏',
                taskbarMenu: '–ú–µ–Ω—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π BlumbOS!',
                fileManager: '–§–∞–π–ª–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä',
                homeFolder: '–î–æ–º–∞—à–Ω—è—è –ø–∞–ø–∫–∞',
                newFolder: '–ù–æ–≤–∞—è –ø–∞–ø–∫–∞',
                newFile: '–ù–æ–≤—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª',
                back: '–ù–∞–∑–∞–¥',
                calculator: '–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä',
                gamesWindow: '–ò–≥—Ä—ã BlumbOS',
                selectGame: '–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É',
                browserTitle: 'BlumbBrowser',
                enterUrl: '–í–≤–µ–¥–∏—Ç–µ URL –∏–ª–∏ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å...'
                , quickGitHub: 'GitHub',
                quickSO: 'Stack Overflow',
                quickWiki: 'Wikipedia',
                quickMDN: 'MDN Docs',
                quickYT: 'YouTube',
                quickReddit: 'Reddit',
                editorSave: '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å',
                editorClose: '–ó–∞–∫—Ä—ã—Ç—å',
                editorPlaceholder: '–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —Ñ–∞–π–ª–∞...',
                editorSaved: '–§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω—ë–Ω',
                editorNotFound: '–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω',
                editorCreated: '–¢–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω',
                editorExists: '–§–∞–π–ª –∏–ª–∏ –ø–∞–ø–∫–∞ —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç',
                folderExists: '–ü–∞–ø–∫–∞ —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç',
                folderCreated: '–ü–∞–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∞',
                folderEmpty: '(–ø–∞–ø–∫–∞ –ø—É—Å—Ç–∞)',
                rename: '–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å',
                delete: '–£–¥–∞–ª–∏—Ç—å',
                renamed: '–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ',
                deleted: '–£–¥–∞–ª–µ–Ω–æ',
                notFound: '–≠–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω',
                confirmDelete: '–£–¥–∞–ª–∏—Ç—å "{name}"?',
                calcClear: 'C',
                calcBack: '‚å´',
                calcEq: '=',
                calcError: '–û—à–∏–±–∫–∞',
                snake: '–ó–º–µ–π–∫–∞',
                tetris: '–¢–µ—Ç—Ä–∏—Å',
                pong: '–ü–æ–Ω–≥',
                sapper: '–°–∞–ø–µ—Ä',
                snakeScore: '–°—á–µ—Ç:',
                snakeLevel: '–£—Ä–æ–≤–µ–Ω—å:',
                tetrisScore: '–°—á–µ—Ç:',
                tetrisLines: '–õ–∏–Ω–∏–∏:',
                pongScore: '–ò–≥—Ä–æ–∫ 1:',
                pongScore2: '–ò–≥—Ä–æ–∫ 2:',
                pongControls: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –ò–≥—Ä–æ–∫ 1 (W/S), –ò–≥—Ä–æ–∫ 2 (‚Üë/‚Üì) | –ü–∞—É–∑–∞: –ü—Ä–æ–±–µ–ª',
                pause: '–ü–∞—É–∑–∞',
                resume: '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å',
                restart: '–ó–∞–Ω–æ–≤–æ',
                menu: '–ú–µ–Ω—é',
                gameOver: '–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í–∞—à —Å—á–µ—Ç: {score}',
                notImplemented: '–µ—â–µ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ!',
                loading: '–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã...',
                cannotEmbed: '–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤—Å—Ç—Ä–æ–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É',
                embedBlocked: '–ù–∞–π–¥–∏—Ç–µ –≤—Å—ë —á—Ç–æ —É–≥–æ–¥–Ω–æ.',
                openProxy: '–û—Ç–∫—Ä—ã—Ç—å —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ (–ª–æ–∫–∞–ª—å–Ω–æ)',
                openExternal: '–û—Ç–∫—Ä—ã—Ç—å –≤–æ –≤–Ω–µ—à–Ω–µ–π –≤–∫–ª–∞–¥–∫–µ',
                copyUrl: '–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å URL',
                proxyHint: '–ü—Ä–æ–∫—Å–∏ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞',
                urlCopied: 'URL —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω',
                urlCopyFailed: '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å URL',
                updatesChecking: 'üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π...',
                updatesLatest: '‚úÖ –°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏',
                animationsOn: '–ê–Ω–∏–º–∞—Ü–∏–∏: –≤–∫–ª—é—á–µ–Ω—ã',
                animationsOff: '–ê–Ω–∏–º–∞—Ü–∏–∏: –≤—ã–∫–ª—é—á–µ–Ω—ã',
                vpnOn: 'VPN: –≤–∫–ª—é—á–µ–Ω',
                vpnOff: 'VPN: –≤—ã–∫–ª—é—á–µ–Ω',
                speedTesting: '‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏...',
                speedResult: 'üìä –°–∫–æ—Ä–æ—Å—Ç—å: {download} –ú–±–∏—Ç/—Å ‚Üì | {upload} –ú–±–∏—Ç/—Å ‚Üë',
                networkInfo: 'IP: {ip}<br>–ü–∞–∫–µ—Ç—ã: {packets} –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ<br>–ó–∞–¥–µ—Ä–∂–∫–∞: {latency} –º—Å',
                notepad: '–ë–ª–æ–∫–Ω–æ—Ç',
                asciiWelcome: '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ BlumbOS!'
            },
            en: {
                system: 'System',
                appearance: 'Appearance',
                network: 'Network',
                systemSettings: 'System Settings',
                language: 'System Language',
                keyboard: 'Keyboard Layout',
                keyboardRu: 'Russian',
                keyboardEn: 'English (US)',
                autostart: 'Autostart',
                autostartDesc: 'Run BlumbOS on startup',
                updates: 'System Updates',
                checkUpdates: 'Check for updates',
                appearanceSettings: 'Appearance Settings',
                theme: 'Color Theme',
                orange: 'Orange Gradient',
                purple: 'Purple Gradient',
                blue: 'Blue Gradient',
                dark: 'Dark',
                transparency: 'Window Transparency',
                fontSize: 'Font Size',
                animations: 'Animations',
                enableAnimations: 'Enable UI animations',
                networkSettings: 'Network Settings',
                wifi: 'Wi-Fi Connection',
                speed: 'Internet Speed',
                testSpeed: 'Test Speed',
                vpn: 'VPN',
                enableVPN: 'Enable VPN connection',
                netMonitor: 'Network Monitor',
                showStats: 'Show statistics',
                files: 'Files',
                browser: 'Browser',
                games: 'Games',
                settings: 'Settings',
                taskbarMenu: 'BlumbOS App Menu!',
                fileManager: 'File Manager',
                homeFolder: 'Home Folder',
                newFolder: 'New Folder',
                newFile: 'New Text File',
                back: 'Back',
                calculator: 'Calculator',
                gamesWindow: 'BlumbOS Games',
                selectGame: 'Select a game',
                browserTitle: 'BlumbBrowser',
                enterUrl: 'Enter URL or search query...'
                , quickGitHub: 'GitHub',
                quickSO: 'Stack Overflow',
                quickWiki: 'Wikipedia',
                quickMDN: 'MDN Docs',
                quickYT: 'YouTube',
                quickReddit: 'Reddit',
                editorSave: 'Save',
                editorClose: 'Close',
                editorPlaceholder: 'Enter file text...',
                editorSaved: 'File saved',
                editorNotFound: 'File not found',
                editorCreated: 'Text file created',
                editorExists: 'File or folder with this name already exists',
                folderExists: 'A folder with this name already exists',
                folderCreated: 'Folder created',
                folderEmpty: '(folder is empty)',
                rename: 'Rename',
                delete: 'Delete',
                renamed: 'Renamed',
                deleted: 'Deleted',
                notFound: 'Item not found',
                confirmDelete: 'Delete "{name}"?',
                calcClear: 'C',
                calcBack: '‚å´',
                calcEq: '=',
                calcError: 'Error',
                snake: 'Snake',
                tetris: 'Tetris',
                pong: 'Pong',
                sapper: 'Minesweeper',
                snakeScore: 'Score:',
                snakeLevel: 'Level:',
                tetrisScore: 'Score:',
                tetrisLines: 'Lines:',
                pongScore: 'Player 1:',
                pongScore2: 'Player 2:',
                pongControls: 'Controls: Player 1 (W/S), Player 2 (‚Üë/‚Üì) | Pause: Space',
                pause: 'Pause',
                resume: 'Resume',
                restart: 'Restart',
                menu: 'Menu',
                gameOver: 'Game over! Your score: {score}',
                notImplemented: 'not implemented yet!',
                loading: 'Loading page...',
                cannotEmbed: 'Cannot embed page',
                embedBlocked: 'Find anything you want.',
                openProxy: 'Open via proxy (local)',
                openExternal: 'Open in external tab',
                copyUrl: 'Copy URL',
                proxyHint: 'Proxy must be running locally at',
                urlCopied: 'URL copied',
                urlCopyFailed: 'Failed to copy URL',
                updatesChecking: 'üîç Checking for updates...',
                updatesLatest: '‚úÖ System is up to date',
                animationsOn: 'Animations: enabled',
                animationsOff: 'Animations: disabled',
                vpnOn: 'VPN: enabled',
                vpnOff: 'VPN: disabled',
                speedTesting: '‚è≥ Testing speed...',
                speedResult: 'üìä Speed: {download} Mbps ‚Üì | {upload} Mbps ‚Üë',
                networkInfo: 'IP: {ip}<br>Packets: {packets} sent<br>Latency: {latency} ms',
                notepad: 'Notepad',
                asciiWelcome: 'Welcome to BlumbOS!'
            },
            es: {
                system: 'Sistema',
                appearance: 'Apariencia',
                network: 'Red',
                systemSettings: 'Configuraci√≥n del sistema',
                language: 'Idioma del sistema',
                keyboard: 'Distribuci√≥n del teclado',
                keyboardRu: 'Ruso',
                keyboardEn: 'Ingl√©s (US)',
                autostart: 'Inicio autom√°tico',
                autostartDesc: 'Ejecutar BlumbOS al iniciar',
                updates: 'Actualizaciones del sistema',
                checkUpdates: 'Buscar actualizaciones',
                appearanceSettings: 'Configuraci√≥n de apariencia',
                theme: 'Tema de color',
                orange: 'Gradiente naranja',
                purple: 'Gradiente p√∫rpura',
                blue: 'Gradiente azul',
                dark: 'Oscuro',
                transparency: 'Transparencia de ventanas',
                fontSize: 'Tama√±o de fuente',
                animations: 'Animaciones',
                enableAnimations: 'Habilitar animaciones de interfaz',
                networkSettings: 'Configuraci√≥n de red',
                wifi: 'Conexi√≥n Wi-Fi',
                speed: 'Velocidad de Internet',
                testSpeed: 'Probar velocidad',
                vpn: 'VPN',
                enableVPN: 'Habilitar conexi√≥n VPN',
                netMonitor: 'Monitor de red',
                showStats: 'Mostrar estad√≠sticas',
                files: 'Archivos',
                browser: 'Navegador',
                games: 'Juegos',
                settings: 'Configuraci√≥n',
                taskbarMenu: '¬°Men√∫ de aplicaciones BlumbOS!',
                fileManager: 'Administrador de archivos',
                homeFolder: 'Carpeta principal',
                newFolder: 'Nueva carpeta',
                newFile: 'Nuevo archivo de texto',
                back: 'Atr√°s',
                calculator: 'Calculadora',
                gamesWindow: 'Juegos BlumbOS',
                selectGame: 'Seleccione un juego',
                browserTitle: 'BlumbBrowser',
                enterUrl: 'Ingrese URL o b√∫squeda...'
                , quickGitHub: 'GitHub',
                quickSO: 'Stack Overflow',
                quickWiki: 'Wikipedia',
                quickMDN: 'MDN Docs',
                quickYT: 'YouTube',
                quickReddit: 'Reddit',
                editorSave: 'Guardar',
                editorClose: 'Cerrar',
                editorPlaceholder: 'Ingrese el texto del archivo...',
                editorSaved: 'Archivo guardado',
                editorNotFound: 'Archivo no encontrado',
                editorCreated: 'Archivo de texto creado',
                editorExists: 'Ya existe un archivo o carpeta con este nombre',
                folderExists: 'Ya existe una carpeta con este nombre',
                folderCreated: 'Carpeta creada',
                folderEmpty: '(la carpeta est√° vac√≠a)',
                rename: 'Renombrar',
                delete: 'Eliminar',
                renamed: 'Renombrado',
                deleted: 'Eliminado',
                notFound: 'Elemento no encontrado',
                confirmDelete: '¬øEliminar "{name}"?',
                calcClear: 'C',
                calcBack: '‚å´',
                calcEq: '=',
                calcError: 'Error',
                snake: 'Serpiente',
                tetris: 'Tetris',
                pong: 'Pong',
                sapper: 'Buscaminas',
                snakeScore: 'Puntuaci√≥n:',
                snakeLevel: 'Nivel:',
                tetrisScore: 'Puntuaci√≥n:',
                tetrisLines: 'L√≠neas:',
                pongScore: 'Jugador 1:',
                pongScore2: 'Jugador 2:',
                pongControls: 'Controles: Jugador 1 (W/S), Jugador 2 (‚Üë/‚Üì) | Pausa: Espacio',
                pause: 'Pausa',
                resume: 'Continuar',
                restart: 'Reiniciar',
                menu: 'Men√∫',
                gameOver: '¬°Juego terminado! Tu puntuaci√≥n: {score}',
                notImplemented: '¬°a√∫n no implementado!',
                loading: 'Cargando p√°gina...',
                cannotEmbed: 'No se puede incrustar la p√°gina',
                embedBlocked: 'Encuentra lo que quieras',
                openProxy: 'Abrir v√≠a proxy (local)',
                openExternal: 'Abrir en pesta√±a externa',
                copyUrl: 'Copiar URL',
                proxyHint: 'El proxy debe estar ejecut√°ndose localmente en',
                urlCopied: 'URL copiado',
                urlCopyFailed: 'No se pudo copiar la URL',
                updatesChecking: 'üîç Buscando actualizaciones...',
                updatesLatest: '‚úÖ El sistema est√° actualizado',
                animationsOn: 'Animaciones: habilitadas',
                animationsOff: 'Animaciones: deshabilitadas',
                vpnOn: 'VPN: habilitado',
                vpnOff: 'VPN: deshabilitado',
                speedTesting: '‚è≥ Probando velocidad...',
                speedResult: 'üìä Velocidad: {download} Mbps ‚Üì | {upload} Mbps ‚Üë',
                networkInfo: 'IP: {ip}<br>Paquetes: {packets} enviados<br>Latencia: {latency} ms',
                notepad: 'Bloc de notas',
                asciiWelcome: '¬°Bienvenido a BlumbOS!'
            }
        };

        // –ü—Ä–∏–º–µ–Ω–∏—Ç—å —è–∑—ã–∫ –∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É
        function applyLanguage(lang) {
            const t = translations[lang] || translations['ru'];
            // –ü–µ—Ä–µ–≤–æ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –æ–∫–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
            const settingsTitle = document.querySelector('#settings-window .window-title');
            if (settingsTitle) settingsTitle.textContent = t.settings + ' BlumbOS';
            // –ü–µ—Ä–µ–≤–æ–¥ –∫–Ω–æ–ø–æ–∫ "–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å" –∏ "–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É"
            const speedBtn = document.querySelector('button[onclick="testSpeed()"]');
            if (speedBtn) speedBtn.textContent = t.testSpeed;
            const statsBtn = document.querySelector('button[onclick="showNetworkInfo()"]');
            if (statsBtn) statsBtn.textContent = t.showStats;
            // –ü–µ—Ä–µ–≤–æ–¥ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
            const termWelcome = document.querySelector('.terminal-body .output');
            if (termWelcome && termWelcome.textContent.trim().match(/–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å|Welcome|Bienvenido/)) {
                termWelcome.textContent = t.asciiWelcome;
            }
            // VFS —Ö—Ä–∞–Ω–∏—Ç —Ç–æ–ª—å–∫–æ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –∫–ª—é—á–∏ ‚Äî –Ω–µ –ª–æ–∫–∞–ª–∏–∑—É–µ–º –∏–º–µ–Ω–∞ –≤ —Å–∞–º–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
            // –í–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.tab')[0].textContent = t.system;
            document.querySelectorAll('.tab')[1].textContent = t.appearance;
            document.querySelectorAll('.tab')[2].textContent = t.network;
            // –ó–∞–≥–æ–ª–æ–≤–∫–∏ –≤–∫–ª–∞–¥–æ–∫
            document.getElementById('system-tab').querySelector('h3').textContent = t.systemSettings;
            document.getElementById('appearance-tab').querySelector('h3').textContent = t.appearanceSettings;
            document.getElementById('network-tab').querySelector('h3').textContent = t.networkSettings;
            // –°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            document.querySelectorAll('.setting-label')[0].textContent = t.language;
            document.querySelectorAll('.setting-label')[1].textContent = t.keyboard;
            // –†–∞—Å–∫–ª–∞–¥–∫–∏
            const kbSel = document.querySelectorAll('.setting-control')[1];
            kbSel.options[0].textContent = t.keyboardRu;
            kbSel.options[1].textContent = t.keyboardEn;
            // –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞
            document.querySelectorAll('.setting-label')[2].textContent = t.autostart;
            document.querySelectorAll('.toggle-switch + span')[0].textContent = t.autostartDesc;
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏—è
            document.querySelectorAll('.setting-label')[3].textContent = t.updates;
            document.querySelectorAll('.button')[3].textContent = t.checkUpdates;
            // –í–Ω–µ—à–Ω–∏–π –≤–∏–¥
            document.querySelectorAll('.setting-label')[4].textContent = t.theme;
            const themeSel = document.querySelectorAll('.setting-control')[2];
            themeSel.options[0].textContent = t.orange;
            themeSel.options[1].textContent = t.purple;
            themeSel.options[2].textContent = t.blue;
            themeSel.options[3].textContent = t.dark;
            document.querySelectorAll('.setting-label')[5].textContent = t.transparency;
            document.querySelectorAll('.setting-label')[6].textContent = t.fontSize;
            document.querySelectorAll('.setting-label')[7].textContent = t.animations;
            document.querySelectorAll('.toggle-switch + span')[1].textContent = t.enableAnimations;
            // –°–µ—Ç—å
            document.querySelectorAll('.setting-label')[8].textContent = t.wifi;
            document.querySelectorAll('.setting-label')[9].textContent = t.speed;
            document.querySelectorAll('.button')[4].textContent = t.testSpeed;
            document.querySelectorAll('.setting-label')[10].textContent = t.vpn;
            document.querySelectorAll('.toggle-switch + span')[2].textContent = t.enableVPN;
            document.querySelectorAll('.setting-label')[11].textContent = t.netMonitor;
            document.querySelectorAll('.button')[5].textContent = t.showStats;
            // –†–∞–±–æ—á–∏–π —Å—Ç–æ–ª
            document.querySelectorAll('.desktop-icon .icon-text')[0].textContent = t.files;
            document.querySelectorAll('.desktop-icon .icon-text')[1].textContent = t.browser;
            document.querySelectorAll('.desktop-icon .icon-text')[2].textContent = t.games;
            document.querySelectorAll('.desktop-icon .icon-text')[3].textContent = t.settings;
            // –ë–ª–æ–∫–Ω–æ—Ç (—á–µ—Ç–≤—ë—Ä—Ç–∞—è –∏–∫–æ–Ω–∫–∞ –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫)
            if (document.querySelectorAll('.desktop-icon .icon-text')[4]) document.querySelectorAll('.desktop-icon .icon-text')[4].textContent = t.notepad;
            // –ü–∞–Ω–µ–ª—å –∑–∞–¥–∞—á
            document.querySelector('.launcher').setAttribute('onclick', 'toggleStartMenu(event)');
            // –û–∫–Ω–∞
            document.querySelector('#files-window .window-title').textContent = t.fileManager;
            document.getElementById('files-title').textContent = t.homeFolder;
            document.getElementById('btn-new-folder').textContent = t.newFolder;
            document.getElementById('btn-new-file').textContent = t.newFile;
            document.getElementById('btn-up').textContent = t.back;
            if (document.querySelector('#notepad-window .window-title')) document.querySelector('#notepad-window .window-title').textContent = t.notepad;
            document.querySelector('#calculator-window .window-title').textContent = t.calculator;
            document.querySelector('#games-window .window-title').textContent = t.gamesWindow;
            document.querySelector('#games-menu h3').textContent = t.selectGame;
            document.querySelector('#browser-window .window-title').textContent = t.browserTitle;
            document.getElementById('browser-address').placeholder = t.enterUrl;
            // –î–æ–º–∞—à–Ω—è—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –±—Ä–∞—É–∑–µ—Ä–∞
            document.querySelector('.browser-home-title').textContent = t.browserTitle;
            document.querySelector('.browser-home-subtitle').textContent = t.enterUrl;
            // –ë—ã—Å—Ç—Ä—ã–µ —Å—Å—ã–ª–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞
            const quicks = document.querySelectorAll('.browser-quicklink > div:last-child');
            if (quicks.length === 6) {
                quicks[0].textContent = t.quickGitHub;
                quicks[1].textContent = t.quickSO;
                quicks[2].textContent = t.quickWiki;
                quicks[3].textContent = t.quickMDN;
                quicks[4].textContent = t.quickYT;
                quicks[5].textContent = t.quickReddit;
            }
            // –ö–Ω–æ–ø–∫–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
            const editorSave = document.getElementById('editor-save');
            if (editorSave) editorSave.textContent = t.editorSave;
            const editorClose = document.getElementById('editor-close');
            if (editorClose) editorClose.textContent = t.editorClose;
            const editorText = document.getElementById('editor-text');
            if (editorText) editorText.placeholder = t.editorPlaceholder;
            // –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä
            const calcBtns = document.querySelectorAll('#calc .button');
            if (calcBtns.length >= 20) {
                calcBtns[0].textContent = t.calcClear;
                calcBtns[1].textContent = t.calcBack;
                calcBtns[19].textContent = t.calcEq;
            }
            // –ò–≥—Ä—ã: –ø–æ–¥–ø–∏—Å–∏ –∏ –∫–Ω–æ–ø–∫–∏
            const snakeStats = document.querySelector('#snake-game .game-stats');
            if (snakeStats) {
                snakeStats.childNodes[0].textContent = t.snakeScore + ' ';
                if (snakeStats.childNodes[2]) snakeStats.childNodes[2].textContent = t.snakeLevel + ' ';
            }
            const tetrisStats = document.querySelector('#tetris-game .game-stats');
            if (tetrisStats) {
                tetrisStats.childNodes[0].textContent = t.tetrisScore + ' ';
                if (tetrisStats.childNodes[2]) tetrisStats.childNodes[2].textContent = t.tetrisLines + ' ';
            }
            const pongStats = document.querySelector('#pong-game .pong-stats');
            if (pongStats) {
                pongStats.childNodes[0].textContent = t.pongScore + ' ';
                if (pongStats.childNodes[2]) pongStats.childNodes[2].textContent = t.pongScore2 + ' ';
            }
            const pongInstr = document.querySelector('#pong-game .pong-instructions');
            if (pongInstr) pongInstr.textContent = t.pongControls;
            // –ö–Ω–æ–ø–∫–∏ –∏–≥—Ä
            const snakeBtns = document.querySelectorAll('#snake-game .button');
            if (snakeBtns.length === 3) {
                snakeBtns[0].textContent = t.pause;
                snakeBtns[1].textContent = t.restart;
                snakeBtns[2].textContent = t.menu;
            }
            const tetrisBtns = document.querySelectorAll('#tetris-game .button');
            if (tetrisBtns.length === 3) {
                tetrisBtns[0].textContent = t.pause;
                tetrisBtns[1].textContent = t.restart;
                tetrisBtns[2].textContent = t.menu;
            }
            const pongBtns = document.querySelectorAll('#pong-game .button');
            if (pongBtns.length === 3) {
                pongBtns[0].textContent = t.pause;
                pongBtns[1].textContent = t.restart;
                pongBtns[2].textContent = t.menu;
            }
            // –ù–∞–∑–≤–∞–Ω–∏—è –∏–≥—Ä –≤ –º–µ–Ω—é
            const gameCards = document.querySelectorAll('.game-card');
            if (gameCards.length >= 4) {
                gameCards[0].querySelector('div:last-child').textContent = t.snake;
                gameCards[1].querySelector('div:last-child').textContent = t.tetris;
                gameCards[2].querySelector('div:last-child').textContent = t.pong;
                gameCards[3].querySelector('div:last-child').textContent = t.sapper;
            }
            // Fallback –±—Ä–∞—É–∑–µ—Ä–∞ (–æ—à–∏–±–∫–∞ iframe)
            const fallbackH2 = document.querySelector('#browser-content h2');
            if (fallbackH2) fallbackH2.textContent = t.cannotEmbed;
            const fallbackP = document.querySelector('#browser-content p');
            if (fallbackP) fallbackP.textContent = t.embedBlocked;
            // –ö–Ω–æ–ø–∫–∏ fallback
            const proxyBtn = document.getElementById('open-proxy');
            if (proxyBtn) proxyBtn.textContent = t.openProxy;
            const extBtn = document.getElementById('open-external');
            if (extBtn) extBtn.textContent = t.openExternal;
            const copyBtn = document.getElementById('copy-url');
            if (copyBtn) copyBtn.textContent = t.copyUrl;
            // –ü—Ä–æ–∫—Å–∏-—Ö–∏–Ω—Ç
            const proxyHint = document.querySelector('#browser-content code');
            if (proxyHint && proxyHint.parentElement && proxyHint.parentElement.textContent.includes('localhost:8080')) {
                proxyHint.parentElement.childNodes[0].textContent = t.proxyHint + ' ';
            }
            // –§–∞–π–ª–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä: –º–µ–Ω—é —Ñ–∞–π–ª–∞/–ø–∞–ø–∫–∏
            document.querySelectorAll('.file-menu button').forEach((btn, i) => {
                if (i % 2 === 0) btn.textContent = t.rename;
                else btn.textContent = t.delete;
            });
            // –ü—É—Å—Ç–∞—è –ø–∞–ø–∫–∞
            document.querySelectorAll('#files-root > div').forEach(div => {
                if (div.textContent === '(–ø–∞–ø–∫–∞ –ø—É—Å—Ç–∞)' || div.textContent === '(folder is empty)' || div.textContent === '(la carpeta est√° vac√≠a)') {
                    div.textContent = t.folderEmpty;
                }
            });
            // –û–∫–Ω–æ –±–ª–æ–∫–Ω–æ—Ç–∞
            const notepadWindow = document.getElementById('notepad-window');
            if (notepadWindow) {
                const saveBtn = notepadWindow.querySelector('#editor-save');
                if (saveBtn) saveBtn.textContent = t.editorSave;
                const closeBtn = notepadWindow.querySelector('#editor-close');
                if (closeBtn) closeBtn.textContent = t.editorClose;
                const textarea = notepadWindow.querySelector('#editor-text');
                if (textarea) textarea.placeholder = t.editorPlaceholder;
            }
        }

        // –ü—Ä–∏–º–µ–Ω–∏—Ç—å —è–∑—ã–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function () {
            let lang = localStorage.getItem('blumbos-lang') || 'ru';
            // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫ –≤ select
            const langSel = document.querySelectorAll('.setting-control')[0];
            langSel.value = lang;
            applyLanguage(lang);
            langSel.onchange = function () { changeLanguage(this.value); };
        });

        function toggleAutostart(enabled) {
            console.log(`–ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞: ${enabled ? '–≤–∫–ª—é—á–µ–Ω–∞' : '–≤—ã–∫–ª—é—á–µ–Ω–∞'}`);
        }

        function checkUpdates() {
            const status = document.getElementById('update-status');
            status.innerHTML = 'üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π...';

            setTimeout(() => {
                status.innerHTML = '‚úÖ –°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏';
            }, 2000);
        }

        function changeTheme(theme, suppressNotify) {
            const themes = {
                orange: 'linear-gradient(135deg, var(--purple) 0%, var(--orange) 50%, var(--purple) 100%)',
                purple: 'linear-gradient(135deg, var(--dark-2) 0%, var(--purple) 50%, var(--dark-2) 100%)',
                blue: 'linear-gradient(135deg, var(--blue-1) 0%, var(--blue-2) 50%, var(--blue-1) 100%)',
                dark: 'linear-gradient(135deg, var(--dark-3) 0%, var(--dark-4) 50%, var(--dark-3) 100%)'
            };

            const taskbarThemes = {
                orange: 'linear-gradient(90deg, var(--purple-90) 0%, var(--orange-90) 100%)',
                purple: 'linear-gradient(90deg, var(--dark-2) 0%, var(--purple-90) 100%)',
                blue: 'linear-gradient(90deg, var(--blue-90) 0%, var(--blue-80) 100%)',
                dark: 'linear-gradient(90deg, var(--dark-90) 0%, var(--dark-80) 100%)'
            };

            const headerThemes = {
                orange: 'linear-gradient(90deg, var(--purple), var(--orange))',
                purple: 'linear-gradient(90deg, var(--purple), var(--purple-2))',
                blue: 'linear-gradient(90deg, var(--blue-1), var(--blue-2))',
                dark: 'linear-gradient(90deg, var(--dark-2), var(--dark-3))'
            };

            const desktopIconThemes = {
                orange: ['linear-gradient(135deg, var(--orange), var(--orange-2))', 'linear-gradient(135deg, var(--purple), var(--purple-2))', 'linear-gradient(135deg, var(--orange-2), var(--orange-3))', 'linear-gradient(135deg, var(--purple-2), var(--purple-3))'],
                purple: ['linear-gradient(135deg, var(--purple), var(--purple-2))', 'linear-gradient(135deg, var(--purple-2), var(--purple-3))', 'linear-gradient(135deg, var(--purple-2), var(--purple-3))', 'linear-gradient(135deg, var(--purple-3), var(--purple))'],
                blue: ['linear-gradient(135deg, var(--blue-1), var(--blue-2))', 'linear-gradient(135deg, var(--blue-2), var(--blue-3))', 'linear-gradient(135deg, var(--blue-3), var(--blue-2))', 'linear-gradient(135deg, var(--blue-2), var(--blue-1))'],
                dark: ['linear-gradient(135deg, var(--dark-1), var(--dark-2))', 'linear-gradient(135deg, var(--dark-2), var(--dark-3))', 'linear-gradient(135deg, var(--dark-3), var(--dark-4))', 'linear-gradient(135deg, var(--dark-4), var(--dark-1))']
            };

            const scrollbarThemes = {
                orange: 'linear-gradient(135deg, var(--orange), var(--purple))',
                purple: 'linear-gradient(135deg, var(--purple), var(--purple-2))',
                blue: 'linear-gradient(135deg, var(--blue-2), var(--blue-1))',
                dark: 'linear-gradient(135deg, var(--dark-3), var(--dark-2))'
            };

            const scrollbarHoverThemes = {
                orange: 'linear-gradient(135deg, var(--orange-2), var(--purple-2))',
                purple: 'linear-gradient(135deg, var(--purple-2), var(--purple-3))',
                blue: 'linear-gradient(135deg, var(--blue-3), var(--blue-2))',
                dark: 'linear-gradient(135deg, var(--dark-4), var(--dark-3))'
            };

            const promptColors = {
                orange: '#e95420',
                purple: '#c973a1',
                blue: '#60a5fa',
                dark: '#cccccc'
            };

            // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ–æ–Ω
            document.body.style.background = themes[theme];

            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞–Ω–µ–ª—å –∑–∞–¥–∞—á
            const taskbar = document.querySelector('.taskbar');
            if (taskbar) {
                taskbar.style.background = taskbarThemes[theme];
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ–∫–æ–Ω (window-header)
            document.querySelectorAll('.window-header').forEach(header => {
                header.style.background = headerThemes[theme];
            });

            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞
            const terminalHeader = document.querySelector('.terminal-header');
            if (terminalHeader) {
                terminalHeader.style.background = headerThemes[theme];
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∫–æ–Ω–∫–∏ –Ω–∞ —Ä–∞–±–æ—á–µ–º —Å—Ç–æ–ª–µ
            const desktopIcons = document.querySelectorAll('.desktop-icon .icon');
            desktopIcons.forEach((icon, index) => {
                icon.style.background = desktopIconThemes[theme][index] || desktopIconThemes[theme][0];
            });

            // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–≤–µ—Ç prompt –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
            document.querySelectorAll('.prompt').forEach(prompt => {
                prompt.style.color = promptColors[theme];
            });

            // –î–æ–±–∞–≤–ª—è–µ–º CSS –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è scrollbar (–∏—Å–ø–æ–ª—å–∑—É—è style —Ç–µ–≥)
            let themeStyle = document.getElementById('theme-scrollbar-style');
            if (!themeStyle) {
                themeStyle = document.createElement('style');
                themeStyle.id = 'theme-scrollbar-style';
                document.head.appendChild(themeStyle);
            }
            themeStyle.innerHTML = `
                .terminal-body::-webkit-scrollbar-thumb {
                    background: ${scrollbarThemes[theme]} !important;
                }
                .terminal-body::-webkit-scrollbar-thumb:hover {
                    background: ${scrollbarHoverThemes[theme]} !important;
                }
                .window-content::-webkit-scrollbar-thumb {
                    background: ${scrollbarThemes[theme]} !important;
                }
                .window-content::-webkit-scrollbar-thumb:hover {
                    background: ${scrollbarHoverThemes[theme]} !important;
                }
            `;

            // –ü–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–∏–º –æ—Å–Ω–æ–≤–Ω—ã–µ CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∞–∫—Ü–µ–Ω—Ç–æ–≤, —á—Ç–æ–±—ã –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã
            // –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç --orange –∏ –µ–≥–æ –≤–∞—Ä–∏–∞—Ü–∏–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –º–µ–Ω—è–ª–∏ —Ü–≤–µ—Ç.
            const root = document.documentElement;
            const cssMap = {
                orange: {
                    '--orange': '#e95420',
                    '--orange-2': '#ff6b35',
                    '--orange-3': '#ff8c42',
                    '--orange-30': 'rgba(233, 84, 32, 0.3)',
                    '--orange-20': 'rgba(233, 84, 32, 0.2)',
                    '--orange-10': 'rgba(233, 84, 32, 0.1)',
                    '--orange-90': 'rgba(233, 84, 32, 0.9)',
                    '--orange-80': 'rgba(233, 84, 32, 0.8)'
                },
                purple: {
                    '--orange': 'var(--purple)',
                    '--orange-2': 'var(--purple-2)',
                    '--orange-3': 'var(--purple-3)',
                    '--orange-30': 'rgba(119, 41, 83, 0.3)',
                    '--orange-20': 'rgba(119, 41, 83, 0.2)',
                    '--orange-10': 'rgba(119, 41, 83, 0.1)',
                    '--orange-90': 'rgba(119, 41, 83, 0.9)',
                    '--orange-80': 'rgba(119, 41, 83, 0.8)'
                },
                blue: {
                    '--orange': 'var(--blue-2)',
                    '--orange-2': 'var(--blue-3)',
                    '--orange-3': '#93c5fd',
                    '--orange-30': 'rgba(59, 130, 246, 0.3)',
                    '--orange-20': 'rgba(59, 130, 246, 0.2)',
                    '--orange-10': 'rgba(59, 130, 246, 0.1)',
                    '--orange-90': 'rgba(59, 130, 246, 0.9)',
                    '--orange-80': 'rgba(59, 130, 246, 0.8)'
                },
                dark: {
                    '--orange': '#444444',
                    '--orange-2': '#555555',
                    '--orange-3': '#666666',
                    '--orange-30': 'rgba(68,68,68,0.3)',
                    '--orange-20': 'rgba(68,68,68,0.2)',
                    '--orange-10': 'rgba(68,68,68,0.1)',
                    '--orange-90': 'rgba(68,68,68,0.9)',
                    '--orange-80': 'rgba(68,68,68,0.8)'
                }
            };

            const map = cssMap[theme] || cssMap.orange;
            Object.keys(map).forEach(key => {
                root.style.setProperty(key, map[key]);
            });

            // –î–æ–±–∞–≤–∏–º/–æ–±–Ω–æ–≤–∏–º —Ü–≤–µ—Ç–∞ –¥–ª—è –∏–∫–æ–Ω–∫–∏ launcher
            const launcherColorMap = {
                orange: ['var(--white-20)', 'var(--white-10)'],
                purple: ['var(--purple-2)', 'var(--purple)'],
                blue: ['var(--blue-2)', 'var(--blue-1)'],
                dark: ['var(--white-25)', 'var(--white-20)']
            };
            const lc = launcherColorMap[theme] || launcherColorMap.orange;
            root.style.setProperty('--launcher-color-1', lc[0]);
            root.style.setProperty('--launcher-color-2', lc[1]);

            // –û–±–Ω–æ–≤–ª—è–µ–º launcher (–∫–Ω–æ–ø–∫–∞ –º–µ–Ω—é) –Ω–∞ –ø–∞–Ω–µ–ª–∏ –∑–∞–¥–∞—á ‚Äî —Ñ–æ–Ω —á–µ—Ä–µ–∑ CSS-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
            const launcherEl = document.querySelector('.launcher');
            if (launcherEl) {
                launcherEl.style.background = `linear-gradient(135deg, var(--launcher-color-1), var(--launcher-color-2))`;
            }

            if (!suppressNotify) showNotification(`–¢–µ–º–∞ –∏–∑–º–µ–Ω–µ–Ω–∞ –Ω–∞: ${theme}`);
        }

        function updateTransparency(value) {
            document.getElementById('transparency-value').textContent = value + '%';
            document.querySelectorAll('.app-window').forEach(window => {
                window.style.opacity = value / 100;
            });
        }

        function updateFontSize(value) {
            document.getElementById('fontsize-value').textContent = value + 'px';
            document.documentElement.style.fontSize = value + 'px';
        }

        function toggleAnimations(enabled) {
            showNotification(`–ê–Ω–∏–º–∞—Ü–∏–∏: ${enabled ? '–≤–∫–ª—é—á–µ–Ω—ã' : '–≤—ã–∫–ª—é—á–µ–Ω—ã'}`);
        }

        function testSpeed() {
            const result = document.getElementById('speed-result');
            result.innerHTML = '‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏...';

            setTimeout(() => {
                const download = (Math.random() * 100 + 50).toFixed(1);
                const upload = (Math.random() * 50 + 25).toFixed(1);
                result.innerHTML = `üìä –°–∫–æ—Ä–æ—Å—Ç—å: ${download} –ú–±–∏—Ç/—Å ‚Üì | ${upload} –ú–±–∏—Ç/—Å ‚Üë`;
            }, 3000);
        }

        function toggleVPN(enabled) {
            showNotification(`VPN: ${enabled ? '–≤–∫–ª—é—á–µ–Ω' : '–≤—ã–∫–ª—é—á–µ–Ω'}`);
        }

        function showNetworkInfo() {
            const info = document.getElementById('network-info');
            const data = {
                ip: '192.168.1.' + Math.floor(Math.random() * 255),
                packets: Math.floor(Math.random() * 1000),
                latency: Math.floor(Math.random() * 50 + 10)
            };

            info.innerHTML = `
            IP: ${data.ip}<br>
            –ü–∞–∫–µ—Ç—ã: ${data.packets} –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ<br>
            –ó–∞–¥–µ—Ä–∂–∫–∞: ${data.latency} –º—Å
        `;
        }

        // –ò–≥—Ä—ã
        function showGamesMenu() {
            document.getElementById('games-menu').style.display = 'block';
            document.getElementById('snake-game').style.display = 'none';
            document.getElementById('tetris-game').style.display = 'none';
            document.getElementById('pong-game').style.display = 'none';
            document.getElementById('minesweeper-game').style.display = 'none';
            currentGame = null;
        }

        function startGame(gameName) {
            if (snakeGame && snakeGame.stop) snakeGame.stop();
            if (tetrisGame && tetrisGame.stop) tetrisGame.stop();
            if (pongGame && pongGame.stop) pongGame.stop();

            document.getElementById('games-menu').style.display = 'none';
            document.getElementById('snake-game').style.display = 'none';
            document.getElementById('tetris-game').style.display = 'none';
            document.getElementById('pong-game').style.display = 'none';
            document.getElementById('minesweeper-game').style.display = 'none';
            currentGame = gameName;

            if (gameName === 'snake') {
                document.getElementById('snake-game').style.display = 'flex';
                initSnake();
            } else if (gameName === 'tetris') {
                document.getElementById('tetris-game').style.display = 'flex';
                initTetris();
            } else if (gameName === 'pong') {
                document.getElementById('pong-game').style.display = 'flex';
                pongGame = initPong();
            } else if (gameName === 'minesweeper') {
                document.getElementById('minesweeper-game').style.display = 'flex';
                initMinesweeper();
            }
        }

        function restartGame(gameName) {
            if (gameName === 'snake') {
                if (snakeGame) snakeGame.stop();
                initSnake();
            } else if (gameName === 'tetris') {
                if (tetrisGame) tetrisGame.stop();
                initTetris();
            } else if (gameName === 'pong') {
                if (pongGame) pongGame.stop();
                pongGame = initPong();
            } else if (gameName === 'minesweeper') {
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–∞–π–º–µ—Ä –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∏–≥—Ä—ã (–µ—Å–ª–∏ –±—ã–ª)
                try {
                    if (minesweeperState && minesweeperState.timerId) {
                        clearInterval(minesweeperState.timerId);
                        minesweeperState.timerId = null;
                    }
                } catch (e) { }
                // –û–±–Ω—É–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞
                try { const timerSpan = document.getElementById('minesweeper-timer'); if (timerSpan) timerSpan.textContent = '0'; } catch (e) { }
                initMinesweeper();
            }
        }

        // --- Minesweeper (–°–∞–ø–µ—Ä) ---
        let minesweeperState = null;
        function initMinesweeper() {
            const rows = 9, cols = 9, mines = 10;
            const boardDiv = document.getElementById('minesweeper-board');
            const mineCountSpan = document.getElementById('minesweeper-mine-count');
            const timerSpan = document.getElementById('minesweeper-timer');
            const statusDiv = document.getElementById('minesweeper-status');

            // State
            let board = Array.from({ length: rows }, () => Array(cols).fill(0));
            let revealed = Array.from({ length: rows }, () => Array(cols).fill(false));
            let flagged = Array.from({ length: rows }, () => Array(cols).fill(false));
            let mineSet = new Set();
            let started = false, timer = 0, timerId = null, gameOver = false;
            let cellsToReveal = rows * cols - mines;

            mineCountSpan.textContent = mines;
            timerSpan.textContent = '0';
            statusDiv.textContent = '';
            boardDiv.innerHTML = '';
            boardDiv.style.pointerEvents = '';

            // Place mines
            while (mineSet.size < mines) {
                const r = Math.floor(Math.random() * rows);
                const c = Math.floor(Math.random() * cols);
                mineSet.add(r + ',' + c);
            }
            mineSet.forEach(pos => { const [r, c] = pos.split(',').map(Number); board[r][c] = 'M'; });

            // Fill numbers
            for (let r = 0; r < rows; r++) {
                for (let c = 0; c < cols; c++) {
                    if (board[r][c] === 'M') continue;
                    let cnt = 0;
                    for (let dr = -1; dr <= 1; dr++) for (let dc = -1; dc <= 1; dc++) {
                        if (dr === 0 && dc === 0) continue;
                        const nr = r + dr, nc = c + dc;
                        if (nr >= 0 && nr < rows && nc >= 0 && nc < cols && board[nr][nc] === 'M') cnt++;
                    }
                    board[r][c] = cnt;
                }
            }

            // Render table
            const table = document.createElement('table');
            table.style.borderCollapse = 'collapse';
            for (let r = 0; r < rows; r++) {
                const tr = document.createElement('tr');
                for (let c = 0; c < cols; c++) {
                    const td = document.createElement('td');
                    td.style.width = '32px'; td.style.height = '32px'; td.style.border = '1px solid var(--white-10)';
                    td.style.textAlign = 'center'; td.style.fontSize = '18px'; td.style.background = 'var(--white-10)'; td.style.cursor = 'pointer';
                    td.dataset.r = r; td.dataset.c = c;
                    td.onclick = () => openCell(r, c);
                    td.oncontextmenu = e => { e.preventDefault(); flagCell(r, c); };
                    tr.appendChild(td);
                }
                table.appendChild(tr);
            }
            boardDiv.appendChild(table);

            function startTimer() { if (timerId) clearInterval(timerId); timerId = setInterval(() => { timer++; timerSpan.textContent = timer; }, 1000); }

            function openCell(r, c) {
                if (gameOver || revealed[r][c] || flagged[r][c]) return; if (!started) { started = true; startTimer(); }
                revealed[r][c] = true; const td = table.rows[r].cells[c]; td.style.background = 'var(--white-25)'; td.style.cursor = 'default'; td.style.fontWeight = 'bold';
                if (board[r][c] === 'M') { td.textContent = 'üí£'; td.style.background = '#e95420'; gameOver = true; statusDiv.textContent = '–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í—ã –ø–æ–¥–æ—Ä–≤–∞–ª–∏—Å—å.'; boardDiv.style.pointerEvents = 'none'; showAllMines(); if (timerId) clearInterval(timerId); return; }
                if (board[r][c] > 0) { td.textContent = board[r][c]; td.style.color = getNumberColor(board[r][c]); cellsToReveal--; }
                else { td.textContent = ''; cellsToReveal--; for (let dr = -1; dr <= 1; dr++) for (let dc = -1; dc <= 1; dc++) { if (dr === 0 && dc === 0) continue; const nr = r + dr, nc = c + dc; if (nr >= 0 && nr < rows && nc >= 0 && nc < cols) { if (!revealed[nr][nc] && !flagged[nr][nc]) openCell(nr, nc); } } }
                checkWin();
            }

            function flagCell(r, c) { if (gameOver || revealed[r][c]) return; flagged[r][c] = !flagged[r][c]; const td = table.rows[r].cells[c]; if (flagged[r][c]) { td.textContent = 'üö©'; td.style.color = '#ffbd2e'; } else td.textContent = ''; }

            function getNumberColor(n) { const colors = ['#1976d2', '#388e3c', '#d32f2f', '#7b1fa2', '#ff6f00', '#00838f', '#c2185b', '#616161']; return colors[n - 1] || '#333'; }

            function showAllMines() { mineSet.forEach(pos => { const [r, c] = pos.split(',').map(Number); const td = table.rows[r].cells[c]; if (!revealed[r][c]) { td.textContent = 'üí£'; td.style.background = '#e95420'; } }); }

            function checkWin() { if (cellsToReveal === 0 && !gameOver) { statusDiv.textContent = '–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏!'; boardDiv.style.pointerEvents = 'none'; if (timerId) clearInterval(timerId); } }

            minesweeperState = { board, revealed, flagged, mineSet, timerId };
        }

        // –ó–º–µ–π–∫–∞
        function initSnake() {
            const canvas = document.getElementById('snake-canvas');
            const ctx = canvas.getContext('2d');
            const gridSize = 20;
            const tileCount = canvas.width / gridSize;
            let snake = [{ x: 10, y: 10 }];
            let food = {};
            let dx = 1;
            let dy = 0;
            let score = 0;
            let level = 1;
            let gameSpeed = 150;
            let gameLoop;
            let isPaused = false;

            function randomFood() {
                let newFood;
                let onSnake;
                do {
                    onSnake = false;
                    newFood = {
                        x: Math.floor(Math.random() * tileCount),
                        y: Math.floor(Math.random() * tileCount)
                    };

                    for (let segment of snake) {
                        if (newFood.x === segment.x && newFood.y === segment.y) {
                            onSnake = true;
                            break;
                        }
                    }
                } while (onSnake);

                food = newFood;
            }

            function drawGame() {
                ctx.fillStyle = getCSSVar('dark-3');
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                ctx.fillStyle = getCSSVar('orange');
                snake.forEach((segment, index) => {
                    if (index === 0) {
                        ctx.fillStyle = getCSSVar('orange-2');
                    } else {
                        ctx.fillStyle = getCSSVar('orange');
                    }
                    ctx.fillRect(segment.x * gridSize, segment.y * gridSize, gridSize - 2, gridSize - 2);
                });

                ctx.fillStyle = getCSSVar('purple');
                ctx.fillRect(food.x * gridSize, food.y * gridSize, gridSize - 2, gridSize - 2);

                document.getElementById('snake-score').textContent = score;
                document.getElementById('snake-level').textContent = level;
            }

            function update() {
                if (isPaused) return;

                const head = { x: snake[0].x + dx, y: snake[0].y + dy };

                if (head.x < 0 || head.x >= tileCount || head.y < 0 || head.y >= tileCount) {
                    gameOver();
                    return;
                }

                for (let i = 1; i < snake.length; i++) {
                    if (head.x === snake[i].x && head.y === snake[i].y) {
                        gameOver();
                        return;
                    }
                }

                snake.unshift(head);

                if (head.x === food.x && head.y === food.y) {
                    score += 10;
                    if (score % 50 === 0) {
                        level++;
                        gameSpeed = Math.max(50, gameSpeed - 10);
                        clearInterval(gameLoop);
                        gameLoop = setInterval(update, gameSpeed);
                    }
                    randomFood();
                } else {
                    snake.pop();
                }

                drawGame();
            }

            function gameOver() {
                clearInterval(gameLoop);
                showNotification(`–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í–∞—à —Å—á–µ—Ç: ${score}`);
                showGamesMenu();
            }

            function handleKeydown(e) {
                if (currentGame !== 'snake') return;

                if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', ' '].includes(e.key)) {
                    e.preventDefault();
                }

                if (e.key === 'ArrowUp' && dy !== 1) {
                    dx = 0;
                    dy = -1;
                } else if (e.key === 'ArrowDown' && dy !== -1) {
                    dx = 0;
                    dy = 1;
                } else if (e.key === 'ArrowLeft' && dx !== 1) {
                    dx = -1;
                    dy = 0;
                } else if (e.key === 'ArrowRight' && dx !== -1) {
                    dx = 1;
                    dy = 0;
                } else if (e.key === ' ' || e.key === 'p') {
                    if (snakeGame && snakeGame.pause) {
                        snakeGame.pause();
                    }
                }
            }

            randomFood();
            drawGame();
            gameLoop = setInterval(update, gameSpeed);
            document.addEventListener('keydown', handleKeydown);

            snakeGame = {
                stop: function () {
                    clearInterval(gameLoop);
                    document.removeEventListener('keydown', handleKeydown);
                },
                pause: function () {
                    isPaused = !isPaused;
                    const button = document.querySelector('#snake-game .button');
                    if (button) {
                        button.textContent = isPaused ? '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å' : '–ü–∞—É–∑–∞';
                    }
                    if (!isPaused) {
                        drawGame();
                    }
                }
            };
        }

        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–∞—É–∑—ã –¥–ª—è Snake
        function snakePause() {
            if (snakeGame && snakeGame.pause) {
                snakeGame.pause();
            }
        }

        // –¢–µ—Ç—Ä–∏—Å
        function initTetris() {
            const canvas = document.getElementById('tetris-canvas');
            const ctx = canvas.getContext('2d');
            const blockSize = 30;
            const cols = 10;
            const rows = 20;

            canvas.width = cols * blockSize;
            canvas.height = rows * blockSize;

            const colors = {
                I: '#00f0f0',
                J: '#0000f0',
                L: '#f0a000',
                O: '#f0f000',
                S: '#00f000',
                T: '#a000f0',
                Z: '#f00000'
            };

            const pieces = {
                I: [[1, 1, 1, 1]],
                J: [[1, 0, 0], [1, 1, 1]],
                L: [[0, 0, 1], [1, 1, 1]],
                O: [[1, 1], [1, 1]],
                S: [[0, 1, 1], [1, 1, 0]],
                T: [[0, 1, 0], [1, 1, 1]],
                Z: [[1, 1, 0], [0, 1, 1]]
            };

            // helper rotate clockwise
            function rotate(matrix) {
                const m = matrix;
                const h = m.length, w = m[0].length;
                const res = Array.from({ length: w }, () => Array(h).fill(0));
                for (let y = 0; y < h; y++) for (let x = 0; x < w; x++) res[x][h - 1 - y] = m[y][x];
                return res;
            }

            function generateRotations(shape) {
                const rots = [];
                let m = shape.map(row => row.slice());
                for (let i = 0; i < 4; i++) {
                    const key = m.map(r => r.join(',')).join('|');
                    if (!rots.some(r => r.key === key)) rots.push({ mat: m, key });
                    m = rotate(m);
                }
                return rots.map(r => r.mat);
            }

            const tetrominoes = {};
            for (const k in pieces) tetrominoes[k] = generateRotations(pieces[k]);

            let board = createMatrix(rows, cols);
            let score = 0;
            let lines = 0;
            let dropInterval = 700; // ms
            let dropTimer = null;
            let isPaused = false;

            let current = null;

            function createMatrix(r, c) {
                return Array.from({ length: r }, () => Array(c).fill(0));
            }

            function spawnPiece() {
                const types = Object.keys(tetrominoes);
                const type = types[Math.floor(Math.random() * types.length)];
                const rots = tetrominoes[type];
                const mat = rots[0];
                current = {
                    type,
                    rots,
                    rot: 0,
                    matrix: mat,
                    pos: { x: Math.floor((cols - mat[0].length) / 2), y: -1 }
                };
                if (collide(board, current)) {
                    // game over
                    stopGame();
                    showNotification('Game Over');
                }
            }

            function collide(board, piece) {
                const m = piece.rots[piece.rot];
                for (let y = 0; y < m.length; y++) {
                    for (let x = 0; x < m[y].length; x++) {
                        if (m[y][x]) {
                            const by = piece.pos.y + y;
                            const bx = piece.pos.x + x;
                            if (by < 0) continue;
                            if (bx < 0 || bx >= cols || by >= rows) return true;
                            if (board[by][bx]) return true;
                        }
                    }
                }
                return false;
            }

            function merge(board, piece) {
                const m = piece.rots[piece.rot];
                for (let y = 0; y < m.length; y++) {
                    for (let x = 0; x < m[y].length; x++) {
                        if (m[y][x]) {
                            const by = piece.pos.y + y;
                            const bx = piece.pos.x + x;
                            if (by >= 0 && by < rows && bx >= 0 && bx < cols) board[by][bx] = piece.type;
                        }
                    }
                }
            }

            function clearLines() {
                let rowCount = 0;
                outer: for (let y = rows - 1; y >= 0; y--) {
                    for (let x = 0; x < cols; x++) {
                        if (!board[y][x]) {
                            continue outer;
                        }
                    }
                    // full
                    const row = board.splice(y, 1)[0];
                    board.unshift(Array(cols).fill(0));
                    y++; // recheck same y after splice
                    rowCount++;
                }
                if (rowCount > 0) {
                    lines += rowCount;
                    score += [0, 100, 300, 500, 800][rowCount] || rowCount * 200;
                    // speed up
                    dropInterval = Math.max(100, 700 - Math.floor(lines / 10) * 50);
                    restartDropTimer();
                }
            }

            function rotatePiece(dir) {
                const prev = current.rot;
                current.rot = (current.rot + dir + current.rots.length) % current.rots.length;
                if (collide(board, current)) {
                    // try wall kicks simple
                    const kicks = [1, -1, 2, -2];
                    let moved = false;
                    for (const k of kicks) {
                        current.pos.x += k;
                        if (!collide(board, current)) { moved = true; break; }
                        current.pos.x -= k;
                    }
                    if (!moved) current.rot = prev;
                }
            }

            function drop() {
                current.pos.y++;
                if (collide(board, current)) {
                    current.pos.y--;
                    merge(board, current);
                    clearLines();
                    spawnPiece();
                }
                draw();
            }

            function hardDrop() {
                while (true) {
                    current.pos.y++;
                    if (collide(board, current)) {
                        current.pos.y--;
                        merge(board, current);
                        clearLines();
                        spawnPiece();
                        draw();
                        return;
                    }
                }
            }

            function move(dir) {
                current.pos.x += dir;
                if (collide(board, current)) current.pos.x -= dir;
                draw();
            }

            function drawCell(x, y, type) {
                const px = x * blockSize, py = y * blockSize;
                ctx.fillStyle = colors[type] || '#777';
                ctx.fillRect(px + 1, py + 1, blockSize - 2, blockSize - 2);
                ctx.strokeStyle = 'rgba(0,0,0,0.25)';
                ctx.strokeRect(px + 1, py + 1, blockSize - 2, blockSize - 2);
            }

            function draw() {
                // background
                ctx.fillStyle = getCSSVar('dark-3') || '#1a1a1a';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // board
                for (let y = 0; y < rows; y++) {
                    for (let x = 0; x < cols; x++) {
                        const cell = board[y][x];
                        if (cell) drawCell(x, y, cell);
                        else {
                            // subtle grid
                            ctx.strokeStyle = 'rgba(255,255,255,0.03)';
                            ctx.strokeRect(x * blockSize + 0.5, y * blockSize + 0.5, blockSize, blockSize);
                        }
                    }
                }

                // current piece
                if (current) {
                    const m = current.rots[current.rot];
                    for (let y = 0; y < m.length; y++) {
                        for (let x = 0; x < m[y].length; x++) {
                            if (m[y][x]) {
                                const bx = current.pos.x + x;
                                const by = current.pos.y + y;
                                if (by >= 0) drawCell(bx, by, current.type);
                            }
                        }
                    }
                }

                document.getElementById('tetris-score').textContent = score;
                document.getElementById('tetris-lines').textContent = lines;
            }

            function restartDropTimer() {
                if (dropTimer) clearInterval(dropTimer);
                dropTimer = setInterval(function () { if (!isPaused && current) drop(); }, dropInterval);
            }

            function keyHandler(e) {
                if (!current) return;
                if (e.key === 'ArrowLeft') { e.preventDefault(); move(-1); }
                else if (e.key === 'ArrowRight') { e.preventDefault(); move(1); }
                else if (e.key === 'ArrowDown') { e.preventDefault(); current.pos.y++; if (collide(board, current)) { current.pos.y--; merge(board, current); clearLines(); spawnPiece(); } draw(); }
                else if (e.key === 'ArrowUp') { e.preventDefault(); rotatePiece(1); }
                else if (e.key === ' ') { e.preventDefault(); hardDrop(); }
                else if (e.key === 'p' || e.key === 'P') { e.preventDefault(); togglePause(); }
            }

            function togglePause() {
                isPaused = !isPaused;
                const btn = document.querySelector('#tetris-game .button:first-child');
                if (btn) btn.textContent = isPaused ? '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å' : '–ü–∞—É–∑–∞';
            }

            function stopGame() {
                if (dropTimer) clearInterval(dropTimer);
                document.removeEventListener('keydown', keyHandler);
                current = null;
                board = createMatrix(rows, cols);
                draw();
            }

            // initialize
            board = createMatrix(rows, cols);
            score = 0; lines = 0; isPaused = false;
            spawnPiece();
            draw();
            restartDropTimer();
            document.removeEventListener('keydown', keyHandler);
            document.addEventListener('keydown', keyHandler);

            tetrisGame = {
                stop: function () { stopGame(); },
                pause: function () { togglePause(); }
            };
        }

        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–∞—É–∑—ã –¥–ª—è Tetris
        function tetrisPause() {
            if (tetrisGame && tetrisGame.pause) {
                tetrisGame.pause();
            }
        }
        // –ü–æ–Ω–≥ - –ø–µ—Ä–µ–ø–∏—Å–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è
        function initPong() {
            const canvas = document.getElementById('pong-canvas');
            const ctx = canvas.getContext('2d');

            // –†–∞–∑–º–µ—Ä—ã
            const paddleWidth = 10;
            const paddleHeight = 80;
            const ballSize = 8;

            // –ü–æ–∑–∏—Ü–∏–∏
            let player1Y = canvas.height / 2 - paddleHeight / 2;
            let player2Y = canvas.height / 2 - paddleHeight / 2;
            let ballX = canvas.width / 2;
            let ballY = canvas.height / 2;
            let ballSpeedX = 4;
            let ballSpeedY = 3;

            // –°—á–µ—Ç
            let score1 = 0;
            let score2 = 0;

            // –°–æ—Å—Ç–æ—è–Ω–∏–µ
            let isPaused = false;
            let gameLoop;

            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
            const keys = {};

            function draw() {
                // –û—á–∏—Å—Ç–∫–∞
                ctx.fillStyle = getCSSVar('dark-3');
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è
                ctx.strokeStyle = getCSSVar('white-06');
                ctx.setLineDash([5, 5]);
                ctx.beginPath();
                ctx.moveTo(canvas.width / 2, 0);
                ctx.lineTo(canvas.width / 2, canvas.height);
                ctx.stroke();
                ctx.setLineDash([]);

                // –†–∞–∫–µ—Ç–∫–∏
                ctx.fillStyle = getCSSVar('orange');
                ctx.fillRect(10, player1Y, paddleWidth, paddleHeight);
                ctx.fillRect(canvas.width - 20, player2Y, paddleWidth, paddleHeight);

                // –ú—è—á
                ctx.fillStyle = getCSSVar('white');
                ctx.beginPath();
                ctx.arc(ballX, ballY, ballSize, 0, Math.PI * 2);
                ctx.fill();

                // –°—á–µ—Ç
                ctx.fillStyle = getCSSVar('white');
                ctx.font = 'bold 32px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(score1, canvas.width / 4, 50);
                ctx.fillText(score2, canvas.width * 3 / 4, 50);

                // –ü–∞—É–∑–∞
                if (isPaused) {
                    ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    ctx.fillStyle = getCSSVar('white');
                    ctx.font = 'bold 36px Arial';
                    ctx.fillText('–ü–ê–£–ó–ê', canvas.width / 2, canvas.height / 2);
                }
            }

            function update() {
                if (isPaused) return;

                // –î–≤–∏–∂–µ–Ω–∏–µ –º—è—á–∞
                ballX += ballSpeedX;
                ballY += ballSpeedY;

                // –û—Ç—Å–∫–æ–∫ –æ—Ç –≤–µ—Ä—Ö–Ω–µ–π –∏ –Ω–∏–∂–Ω–µ–π —Å—Ç–µ–Ω–∫–∏
                if (ballY - ballSize < 0 || ballY + ballSize > canvas.height) {
                    ballSpeedY = -ballSpeedY;
                }

                // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å –ª–µ–≤–æ–π —Ä–∞–∫–µ—Ç–∫–æ–π
                if (ballX - ballSize < 20 &&
                    ballY > player1Y &&
                    ballY < player1Y + paddleHeight) {
                    ballSpeedX = -ballSpeedX;
                    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å –ø–æ—Å–ª–µ —É–¥–∞—Ä–∞
                    ballSpeedX *= 1.1;
                    ballSpeedY *= 1.1;
                }

                // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å –ø—Ä–∞–≤–æ–π —Ä–∞–∫–µ—Ç–∫–æ–π
                if (ballX + ballSize > canvas.width - 20 &&
                    ballY > player2Y &&
                    ballY < player2Y + paddleHeight) {
                    ballSpeedX = -ballSpeedX;
                    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å –ø–æ—Å–ª–µ —É–¥–∞—Ä–∞
                    ballSpeedX *= 1.1;
                    ballSpeedY *= 1.1;
                }

                // –ì–æ–ª –≤ –ª–µ–≤—ã–µ –≤–æ—Ä–æ—Ç–∞
                if (ballX < 0) {
                    score2++;
                    resetBall();
                }

                // –ì–æ–ª –≤ –ø—Ä–∞–≤—ã–µ –≤–æ—Ä–æ—Ç–∞
                if (ballX > canvas.width) {
                    score1++;
                    resetBall();
                }

                // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–º 1 (W/S)
                if (keys['KeyW'] && player1Y > 0) {
                    player1Y -= 6;
                }
                if (keys['KeyS'] && player1Y < canvas.height - paddleHeight) {
                    player1Y += 6;
                }

                // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–º 2 (–°—Ç—Ä–µ–ª–∫–∏)
                if (keys['ArrowUp'] && player2Y > 0) {
                    player2Y -= 6;
                }
                if (keys['ArrowDown'] && player2Y < canvas.height - paddleHeight) {
                    player2Y += 6;
                }

                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç–∞ –Ω–∞ —ç–∫—Ä–∞–Ω–µ
                document.getElementById('pong-score1').textContent = score1;
                document.getElementById('pong-score2').textContent = score2;

                draw();
            }

            function resetBall() {
                ballX = canvas.width / 2;
                ballY = canvas.height / 2;
                ballSpeedX = (Math.random() > 0.5 ? 1 : -1) * 4;
                ballSpeedY = (Math.random() - 0.5) * 6;
            }

            function handleKeydown(e) {
                keys[e.code] = true;

                if (e.code === 'Space') {
                    e.preventDefault();
                    pausePong();
                }
            }

            function handleKeyup(e) {
                keys[e.code] = false;
            }

            // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
            resetBall();
            draw();
            gameLoop = setInterval(update, 1000 / 60);

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            document.addEventListener('keydown', handleKeydown);
            document.addEventListener('keyup', handleKeyup);

            return {
                stop: function () {
                    clearInterval(gameLoop);
                    document.removeEventListener('keydown', handleKeydown);
                    document.removeEventListener('keyup', handleKeyup);
                },
                pause: function () {
                    isPaused = !isPaused;
                    const button = document.querySelector('#pong-game .button:first-child');
                    if (button) {
                        button.textContent = isPaused ? '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å' : '–ü–∞—É–∑–∞';
                    }
                    if (!isPaused) {
                        draw();
                    }
                }
            };
        }

        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–∞—É–∑—ã –¥–ª—è Pong
        function pausePong() {
            if (pongGame && pongGame.pause) {
                pongGame.pause();
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è startGame
        function startGame(gameName) {
            document.getElementById('games-menu').style.display = 'none';
            document.getElementById('snake-game').style.display = 'none';
            document.getElementById('tetris-game').style.display = 'none';
            document.getElementById('pong-game').style.display = 'none';
            document.getElementById('minesweeper-game').style.display = 'none';
            currentGame = gameName;

            if (gameName === 'snake') {
                document.getElementById('snake-game').style.display = 'flex';
                initSnake();
            } else if (gameName === 'tetris') {
                document.getElementById('tetris-game').style.display = 'flex';
                initTetris();
            } else if (gameName === 'pong') {
                document.getElementById('pong-game').style.display = 'flex';
                pongGame = initPong();
            } else if (gameName === 'minesweeper') {
                document.getElementById('minesweeper-game').style.display = 'flex';
                initMinesweeper();
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è restartGame
        function restartGame(gameName) {
            if (gameName === 'snake') {
                if (snakeGame) snakeGame.stop();
                initSnake();
            } else if (gameName === 'tetris') {
                if (tetrisGame) tetrisGame.stop();
                initTetris();
            } else if (gameName === 'pong') {
                if (pongGame) pongGame.stop();
                pongGame = initPong();
            } else if (gameName === 'minesweeper') {
                // Clear previous timer if any and reset UI timer
                try {
                    if (minesweeperState && minesweeperState.timerId) {
                        clearInterval(minesweeperState.timerId);
                        minesweeperState.timerId = null;
                    }
                } catch (e) { }
                try { const timerSpan = document.getElementById('minesweeper-timer'); if (timerSpan) timerSpan.textContent = '0'; } catch (e) { }
                // Also reset any stored timer value if present
                try { if (minesweeperState) minesweeperState.timer = 0; } catch (e) { }
                initMinesweeper();
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è showGamesMenu
        function showGamesMenu() {
            document.getElementById('games-menu').style.display = 'block';
            document.getElementById('snake-game').style.display = 'none';
            document.getElementById('tetris-game').style.display = 'none';
            document.getElementById('pong-game').style.display = 'none';
            document.getElementById('minesweeper-game').style.display = 'none';

            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –∏–≥—Ä—ã
            try { if (snakeGame) snakeGame.stop(); } catch (e) { }
            try { if (tetrisGame) tetrisGame.stop(); } catch (e) { }
            try { if (pongGame) pongGame.stop(); } catch (e) { }
            try { if (minesweeperState && minesweeperState.timerId) clearInterval(minesweeperState.timerId); } catch (e) { }

            currentGame = null;
        }

        // –§—É–Ω–∫—Ü–∏–∏ –±—Ä–∞—É–∑–µ—Ä–∞
        let browserHistory = [];
        let browserHistoryIndex = -1;
        let currentUrl = '';

        function browserNavigateTo(url) {
            // –ü–æ–ª—É—á–∞–µ–º —á–∏—Å—Ç—ã–π URL
            if (!url.includes('://')) {
                url = 'https://' + url;
            }

            // –û—á–∏—â–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –ø–æ—Å–ª–µ —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏
            browserHistory = browserHistory.slice(0, browserHistoryIndex + 1);
            browserHistory.push(url);
            browserHistoryIndex++;

            currentUrl = url;
            displayBrowserContent(url);
            updateBrowserUI();
        }

        function browserSearch(query) {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º DuckDuckGo –¥–ª—è –ø–æ–∏—Å–∫–∞ (—Ç–µ–ø–µ—Ä—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏)
            const searchUrl = `https://duckduckgo.com/?q=${encodeURIComponent(query)}`;
            browserNavigateTo(searchUrl);
        }

        function browserNavigate() {
            const input = document.getElementById('browser-address');
            const query = input.value.trim();

            if (!query) return;

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —ç—Ç–æ URL –∏–ª–∏ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
            if (query.includes('http://') || query.includes('https://') || query.includes('.com') || query.includes('.org') || query.includes('.net')) {
                browserNavigateTo(query);
            } else {
                // –≠—Ç–æ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å - –∏—Å–ø–æ–ª—å–∑—É–µ–º DuckDuckGo
                browserSearch(query);
            }
        }

        function browserNavigateBack() {
            if (browserHistoryIndex > 0) {
                browserHistoryIndex--;
                currentUrl = browserHistory[browserHistoryIndex];
                displayBrowserContent(currentUrl);
                updateBrowserUI();
            }
        }

        function browserNavigateForward() {
            if (browserHistoryIndex < browserHistory.length - 1) {
                browserHistoryIndex++;
                currentUrl = browserHistory[browserHistoryIndex];
                displayBrowserContent(currentUrl);
                updateBrowserUI();
            }
        }

        function browserReload() {
            if (currentUrl) {
                displayBrowserContent(currentUrl);
            }
        }

        function browserHome() {
            const homeContent = document.getElementById('browser-home');
            const content = document.getElementById('browser-content');
            content.innerHTML = homeContent.innerHTML;
            document.getElementById('browser-address').value = '';
            currentUrl = '';
            browserHistory = [];
            browserHistoryIndex = -1;
            updateBrowserUI();
        }

        function updateBrowserUI() {
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–¥—Ä–µ—Å–Ω—É—é —Å—Ç—Ä–æ–∫—É
            document.getElementById('browser-address').value = currentUrl;

            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            document.getElementById('browser-back').disabled = browserHistoryIndex <= 0;
            document.getElementById('browser-forward').disabled = browserHistoryIndex >= browserHistory.length - 1;
        }

        function displayBrowserContent(url) {
            const contentDiv = document.getElementById('browser-content');

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
            contentDiv.innerHTML = '<div class="browser-loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã...</div>';

            // –ò—Å–ø–æ–ª—å–∑—É–µ–º setTimeout —á—Ç–æ–±—ã –∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É
            setTimeout(() => {
                // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º URL (–¥–æ–±–∞–≤–ª—è–µ–º —Å—Ö–µ–º—É –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
                try { new URL(url); } catch (e) { url = 'https://' + url; }

                // –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ–∫—Å–∏-—ç–Ω–¥–ø–æ–∏–Ω—Ç. –ü–æ–ø—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å HTML —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏,
                // –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –≤—Å–µ —Ä–µ—Å—É—Ä—Å—ã –Ω–∞ –ø—Ä–æ–∫—Å–∏-URL –∏ –≤—Å—Ç–∞–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ iframe.srcdoc.
                // –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–∫–∂–µ –≤—Å–µ –ø–æ–¥—Ä–µ—Å—É—Ä—Å—ã –∏ –∏–∑–±–µ–∂–∞—Ç—å CORS/MIME –ø—Ä–æ–±–ª–µ–º.
                const proxyBase = 'https://blumbos.onrender.com/proxy?url=';
                const proxyUrl = proxyBase + encodeURIComponent(url);

                contentDiv.innerHTML = '';
                const iframe = document.createElement('iframe');
                iframe.style.width = '100%';
                iframe.style.height = '100%';
                iframe.style.border = 'none';
                iframe.setAttribute('sandbox', 'allow-same-origin allow-scripts allow-forms allow-popups');

                // Helper: resolve resource URL relative to page URL
                function resolveResource(res) {
                    try { return new URL(res, url).toString(); } catch (e) { return res; }
                }

                // Helper: convert a resource absolute URL into proxied URL
                function proxify(resolved) {
                    return proxyBase + encodeURIComponent(resolved);
                }

                // Fetch HTML from proxy, rewrite asset URLs to go through proxy, insert via srcdoc
                fetch(proxyUrl, { method: 'GET' })
                    .then(r => {
                        if (!r.ok) throw new Error('Proxy returned ' + r.status);
                        return r.text();
                    })
                    .then(html => {
                        try {
                            const parser = new DOMParser();
                            const doc = parser.parseFromString(html, 'text/html');

                            // Remove CSP meta tags that may block embedding
                            doc.querySelectorAll('meta[http-equiv]').forEach(m => {
                                const he = (m.getAttribute('http-equiv') || '').toLowerCase();
                                if (he.includes('content-security-policy') || he.includes('x-frame-options')) m.remove();
                            });

                            // Rewrite src, href, data, poster, srcset attributes
                            const sel = '[src],[href],[data],[poster],[srcset]';
                            doc.querySelectorAll(sel).forEach(el => {
                                // handle srcset separately
                                if (el.hasAttribute('srcset')) {
                                    const ss = el.getAttribute('srcset');
                                    const parts = ss.split(',').map(p => p.trim()).map(item => {
                                        const [u, desc] = item.split(/\s+/);
                                        const resolved = resolveResource(u);
                                        return proxify(resolved) + (desc ? ' ' + desc : '');
                                    });
                                    el.setAttribute('srcset', parts.join(', '));
                                }

                                if (el.hasAttribute('src')) {
                                    const r = el.getAttribute('src');
                                    const resolved = resolveResource(r);
                                    el.setAttribute('src', proxify(resolved));
                                }
                                if (el.hasAttribute('href')) {
                                    const r = el.getAttribute('href');
                                    // skip javascript: and mailto: links
                                    if (/^(javascript:|mailto:|#)/i.test(r)) return;
                                    const resolved = resolveResource(r);
                                    el.setAttribute('href', proxify(resolved));
                                }
                                if (el.hasAttribute('data')) {
                                    const r = el.getAttribute('data');
                                    const resolved = resolveResource(r);
                                    el.setAttribute('data', proxify(resolved));
                                }
                                if (el.hasAttribute('poster')) {
                                    const r = el.getAttribute('poster');
                                    const resolved = resolveResource(r);
                                    el.setAttribute('poster', proxify(resolved));
                                }
                            });

                            // Rewrite inline styles and style blocks with url(...)
                            function rewriteCssText(text) {
                                return text.replace(/url\(([^)]+)\)/g, (m, p1) => {
                                    const u = p1.replace(/^["']|["']$/g, '').trim();
                                    if (/^(data:|about:|javascript:)/i.test(u)) return `url(${u})`;
                                    const resolved = resolveResource(u);
                                    return `url(${proxify(resolved)})`;
                                });
                            }

                            doc.querySelectorAll('style').forEach(s => {
                                s.textContent = rewriteCssText(s.textContent);
                            });
                            doc.querySelectorAll('[style]').forEach(el => {
                                el.setAttribute('style', rewriteCssText(el.getAttribute('style')));
                            });

                            // Add a <base> so that any remaining relative URLs resolve against original site
                            const base = doc.querySelector('base') || doc.createElement('base');
                            base.setAttribute('href', url);
                            if (!doc.head.querySelector('base')) doc.head.insertBefore(base, doc.head.firstChild);

                            // Inject script to force all navigations to go through proxy
                            const inject = doc.createElement('script');
                            inject.textContent = `(function(){
                                const proxyBase = '${proxyBase}';
                                function resolveUrl(u){ try { return new URL(u, document.baseURI).toString(); } catch(e) { return u; } }
                                function proxify(u){ return proxyBase + encodeURIComponent(resolveUrl(u)); }

                                // Override window.open
                                try {
                                    const _open = window.open.bind(window);
                                    window.open = function(u, name, specs){
                                        try { if (typeof u === 'string' && !/^(javascript:|mailto:|#)/i.test(u)) u = proxify(u); } catch(e){}
                                        return _open(u, name, specs);
                                    };
                                } catch(e) {}

                                // Override location methods
                                try {
                                    const _assign = location.assign.bind(location);
                                    location.assign = function(u){ if (typeof u === 'string' && !/^(javascript:|mailto:|#)/i.test(u)) u = proxify(u); return _assign(u); };
                                    const _replace = location.replace.bind(location);
                                    location.replace = function(u){ if (typeof u === 'string' && !/^(javascript:|mailto:|#)/i.test(u)) u = proxify(u); return _replace(u); };
                                } catch(e) {}

                                // Intercept clicks on links
                                document.addEventListener('click', function(e){
                                    const a = e.target.closest && e.target.closest('a');
                                    if (!a) return;
                                    const href = a.getAttribute('href');
                                    if (!href) return;
                                    if (/^(javascript:|mailto:|#)/i.test(href)) return;
                                    e.preventDefault();
                                    const prox = proxify(href);
                                    const target = a.getAttribute('target');
                                    if (target && target !== '_self') {
                                        window.open(prox, target);
                                    } else {
                                        location.href = prox;
                                    }
                                }, true);

                                // Intercept form submissions
                                document.addEventListener('submit', function(e){
                                    const f = e.target;
                                    if (!f || f.tagName !== 'FORM') return;
                                    try {
                                        const action = f.getAttribute('action') || document.baseURI;
                                        f.setAttribute('action', proxify(action));
                                    } catch(e) {}
                                }, true);
                            })();`;
                            doc.head.insertBefore(inject, doc.head.firstChild);

                            // Serialize and insert
                            const finalHtml = '<!doctype html>\n' + doc.documentElement.outerHTML;
                            iframe.srcdoc = finalHtml;
                            contentDiv.appendChild(iframe);
                            updateBrowserUI();
                        } catch (e) {
                            // Parsing/rewriting failed ‚Äî fallback to simple iframe.src
                            iframe.src = proxyUrl;
                            contentDiv.appendChild(iframe);
                            updateBrowserUI();
                        }
                    })
                    .catch(err => {
                        // On any error, fallback to iframe.src
                        iframe.src = proxyUrl;
                        contentDiv.appendChild(iframe);
                        updateBrowserUI();
                    });
            }, 800);
        }

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ–∫—Å–∏ –∏ –≤—Å—Ç—Ä–æ–∏—Ç—å –≤ iframe
        function loadProxyIframe(url) {
            const contentDiv = document.getElementById('browser-content');
            contentDiv.innerHTML = '<div class="browser-loading">–ó–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏...</div>';

            const proxyBase = 'https://blumbos.onrender.com/proxy?url=';
            const proxyUrl = proxyBase + encodeURIComponent(url);

            contentDiv.innerHTML = '';
            const iframe = document.createElement('iframe');
            iframe.style.width = '100%';
            iframe.style.height = '100%';
            iframe.style.border = 'none';
            iframe.setAttribute('sandbox', 'allow-same-origin allow-scripts allow-forms allow-popups');
            iframe.src = proxyUrl;
            contentDiv.appendChild(iframe);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±—Ä–∞—É–∑–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞

        function showAsciiLogo() {
            const asciiLogo = `
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                                                                   ‚ïë
‚ïë    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó     ‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ïë
‚ïë    ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù  ‚ïë
‚ïë    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ñà‚ñà‚ñà‚ñà‚ïî‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ïë
‚ïë    ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïë  ‚ïë
‚ïë    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë ‚ïö‚ïê‚ïù ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë  ‚ïë
‚ïë    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù  ‚ïë
‚ïë                                                                   ‚ïë
‚ïë                        BlumbOS 22.04 LTS                          ‚ïë
‚ïë                                                                   ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
        `;

            const logoElement = document.createElement('div');
            logoElement.className = 'ascii-logo';
            logoElement.textContent = asciiLogo;
            document.body.appendChild(logoElement);
        }

        // –ü—Ä–æ—Å—Ç–∞—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ (in-memory)
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –∫–ª—é—á–∏ –ø–∞–ø–æ–∫ (–Ω–µ –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–º–µ–Ω–∞ –≤ VFS)
        const vfs = {
            name: 'home',
            children: {
                'Documents': { type: 'folder', children: {} },
                'Downloads': { type: 'folder', children: {} },
                'Music': { type: 'folder', children: {} },
                'Pictures': { type: 'folder', children: {} },
                'Videos': { type: 'folder', children: {} },
                'Desktop': { type: 'folder', children: {} }
            }
        };

        let currentPath = []; // –º–∞—Å—Å–∏–≤ –∏–º—ë–Ω –ø–∞–ø–æ–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä ['–î–æ–∫—É–º–µ–Ω—Ç—ã']
        let currentNode = vfs;
        let editingFile = null; // {node, name}

        function getNodeByPath(pathArr) {
            let node = vfs;
            for (const p of pathArr) {
                if (!node.children || !node.children[p]) return null;
                node = node.children[p];
            }
            return node;
        }

        function renderCurrentFolder() {
            const root = document.getElementById('files-root');
            const title = document.getElementById('files-title');
            const pathName = currentPath.length ? currentPath.join('/') : '–î–æ–º–∞—à–Ω—è—è –ø–∞–ø–∫–∞';
            title.textContent = pathName;

            const node = getNodeByPath(currentPath) || vfs;
            currentNode = node;

            root.innerHTML = '';

            const entries = node.children || {};
            const keys = Object.keys(entries);
            if (keys.length === 0) {
                const empty = document.createElement('div');
                empty.style.color = getCSSVar('muted');
                empty.textContent = '(–ø–∞–ø–∫–∞ –ø—É—Å—Ç–∞)';
                root.appendChild(empty);
                return;
            }

            keys.forEach(name => {
                const item = entries[name];
                const container = document.createElement('div');
                container.className = 'item-container';

                const el = document.createElement('div');
                el.className = 'folder-icon';
                el.style.display = 'flex';
                el.style.flexDirection = 'column';
                el.style.alignItems = 'center';
                el.style.justifyContent = 'center';
                el.style.padding = '12px';
                el.style.minHeight = '80px';

                const contentDiv = document.createElement('div');
                contentDiv.style.width = '100%';
                contentDiv.style.height = '100%';
                contentDiv.style.display = 'flex';
                contentDiv.style.flexDirection = 'column';
                contentDiv.style.alignItems = 'center';
                contentDiv.style.justifyContent = 'center';

                if (item.type === 'folder') {
                    contentDiv.innerHTML = `<div style=\"font-size:28px;margin-bottom:6px\">üìÅ</div><div style=\"font-size:13px;text-align:center\">${name}</div>`;
                    contentDiv.onclick = () => { openFolder(name); };
                } else if (item.type === 'image') {
                    // –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–≤—å—é –∏ –æ—Ç–∫—Ä—ã–≤–∞–µ–º –≤ Paint
                    const thumb = document.createElement('img');
                    thumb.src = item.data || '';
                    thumb.style.width = '72px';
                    thumb.style.height = '72px';
                    thumb.style.objectFit = 'cover';
                    thumb.style.borderRadius = '6px';
                    thumb.style.marginBottom = '6px';
                    const label = document.createElement('div');
                    label.style.fontSize = '13px';
                    label.style.textAlign = 'center';
                    label.textContent = name;
                    contentDiv.appendChild(thumb);
                    contentDiv.appendChild(label);
                    contentDiv.onclick = () => { openImageInPaint(name); };
                } else {
                    contentDiv.innerHTML = `<div style=\"font-size:28px;margin-bottom:6px\">üìÑ</div><div style=\"font-size:13px;text-align:center\">${name}</div>`;
                    contentDiv.onclick = () => { openTextFile(name); };
                }

                // –ö–Ω–æ–ø–∫–∞ –º–µ–Ω—é (—Ç—Ä–æ–µ—Ç–æ—á–∏–µ) –¥–ª—è —Ñ–∞–π–ª–∞/–ø–∞–ø–∫–∏
                const menuBtn = document.createElement('div');
                menuBtn.className = 'menu-button';
                menuBtn.innerHTML = '‚ãÆ';
                menuBtn.title = '–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é';

                // –ú–µ–Ω—é –¥–µ–π—Å—Ç–≤–∏–π
                const menu = document.createElement('div');
                menu.className = 'file-menu';

                const renameBtn = document.createElement('button');
                renameBtn.textContent = '–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å';
                renameBtn.onclick = (e) => { e.stopPropagation(); renameEntry(name); menu.style.display = 'none'; };

                const deleteBtn = document.createElement('button');
                deleteBtn.textContent = '–£–¥–∞–ª–∏—Ç—å';
                deleteBtn.onclick = (e) => { e.stopPropagation(); deleteEntry(name); menu.style.display = 'none'; };

                menu.appendChild(renameBtn);
                menu.appendChild(deleteBtn);

                menuBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    // –°–∫—Ä—ã—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ–Ω—é
                    document.querySelectorAll('.file-menu').forEach(m => { if (m !== menu) m.style.display = 'none'; });
                    menu.style.display = (menu.style.display === 'block') ? 'none' : 'block';
                });

                // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ
                container.addEventListener('click', () => { menu.style.display = 'none'; });

                el.appendChild(contentDiv);
                container.appendChild(el);
                container.appendChild(menuBtn);
                container.appendChild(menu);
                root.appendChild(container);
            });
        }

        function openFolder(name) {
            currentPath.push(name);
            renderCurrentFolder();
        }

        function goUp() {
            if (currentPath.length > 0) {
                currentPath.pop();
                renderCurrentFolder();
            }
        }

        function createFolder() {
            const name = prompt('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –Ω–æ–≤–æ–π –ø–∞–ø–∫–∏:');
            if (!name) return;
            const node = getNodeByPath(currentPath) || vfs;
            if (!node.children) node.children = {};
            if (node.children[name]) { showNotification('–ü–∞–ø–∫–∞ —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç'); return; }
            node.children[name] = { type: 'folder', children: {} };
            renderCurrentFolder();
            showNotification('–ü–∞–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∞');
        }

        function createTextFile() {
            const name = prompt('–í–≤–µ–¥–∏—Ç–µ –∏–º—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞ (—Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º .txt):');
            if (!name) return;
            const node = getNodeByPath(currentPath) || vfs;
            if (!node.children) node.children = {};
            if (node.children[name]) { showNotification('–§–∞–π–ª –∏–ª–∏ –ø–∞–ø–∫–∞ —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç'); return; }
            node.children[name] = { type: 'file', content: '' };
            renderCurrentFolder();
            showNotification('–¢–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω');
            openTextFile(name);
        }

        function openTextFile(name) {
            const node = getNodeByPath(currentPath) || vfs;
            const file = node.children && node.children[name];
            if (!file || file.type !== 'file') { showNotification('–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω'); return; }
            editingFile = { node, name };
            document.getElementById('editor-filename').textContent = name;
            document.getElementById('editor-text').value = file.content || '';
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–æ –±–ª–æ–∫–Ω–æ—Ç–∞ –∏ —Å—Ç–∞–≤–∏–º —Ñ–æ–∫—É—Å
            openApp('notepad');
            setTimeout(() => {
                const ta = document.getElementById('editor-text');
                if (ta) { ta.focus(); ta.selectionStart = ta.value.length; }
            }, 50);
        }

        function saveEditor() {
            const text = document.getElementById('editor-text').value;
            // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç —Ñ–∞–π–ª –∏–∑ VFS ‚Äî –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º
            if (editingFile) {
                editingFile.node.children[editingFile.name].content = text;
                closeApp('notepad');
                editingFile = null;
                showNotification('–§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω—ë–Ω');
                return;
            }

            // –ò–Ω–∞—á–µ ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–∫ –Ω–æ–≤—ã–π —Ñ–∞–π–ª –≤ —Ç–µ–∫—É—â—É—é –ø–∞–ø–∫—É
            const name = prompt('–í–≤–µ–¥–∏—Ç–µ –∏–º—è —Ñ–∞–π–ª–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä note.txt):');
            if (!name) return;
            const node = getNodeByPath(currentPath) || vfs;
            if (!node.children) node.children = {};
            if (node.children[name]) {
                const ok = confirm('–§–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å?');
                if (!ok) return;
            }
            node.children[name] = { type: 'file', content: text };
            closeApp('notepad');
            renderCurrentFolder();
            showNotification('–§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω—ë–Ω');
        }

        function closeEditor() {
            closeApp('notepad');
            editingFile = null;
        }

        // –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ
        function renameEntry(oldName) {
            const node = getNodeByPath(currentPath) || vfs;
            if (!node.children || !node.children[oldName]) { showNotification('–≠–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω'); return; }
            const newName = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –∏–º—è:', oldName);
            if (!newName || newName === oldName) return;
            if (node.children[newName]) { showNotification('–≠–ª–µ–º–µ–Ω—Ç —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç'); return; }
            node.children[newName] = node.children[oldName];
            delete node.children[oldName];
            renderCurrentFolder();
            showNotification('–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ');
        }

        function deleteEntry(name) {
            const node = getNodeByPath(currentPath) || vfs;
            if (!node.children || !node.children[name]) { showNotification('–≠–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω'); return; }
            const ok = confirm(`–£–¥–∞–ª–∏—Ç—å "${name}"?`);
            if (!ok) return;
            delete node.children[name];
            renderCurrentFolder();
            showNotification('–£–¥–∞–ª–µ–Ω–æ');
        }


        // Paint: —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è, –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
        function openImageInPaint(name) {
            // –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–∏ –≤ Paint
            const node = getNodeByPath(currentPath) || vfs;
            let item = node.children && node.children[name];
            // –µ—Å–ª–∏ –Ω–µ –≤ —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–µ ‚Äî –ø–æ–ø—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ –≤ Pictures
            if (!item) {
                const pics = getNodeByPath(['Pictures']);
                if (pics && pics.children && pics.children[name]) item = pics.children[name];
            }
            if (!item || item.type !== 'image') { showNotification('–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ'); return; }
            openApp('paint');
            setTimeout(() => {
                const canvas = document.getElementById('paint-canvas');
                const ctx = canvas.getContext('2d');
                const img = new Image();
                img.onload = function () {
                    // –ø–æ–¥–≥–æ–Ω—è–µ–º —Ä–∞–∑–º–µ—Ä —Ö–æ–ª—Å—Ç–∞ –ø–æ–¥ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏–º
                    const maxW = Math.max(400, Math.min(img.naturalWidth, window.innerWidth - 200));
                    const maxH = Math.max(300, Math.min(img.naturalHeight, window.innerHeight - 180));
                    canvas.width = maxW;
                    canvas.height = maxH;
                    // —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è undo
                    try { pushPaintState(); } catch (e) { }
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    // —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏
                    const ratio = Math.min(canvas.width / img.naturalWidth, canvas.height / img.naturalHeight);
                    const w = img.naturalWidth * ratio;
                    const h = img.naturalHeight * ratio;
                    ctx.drawImage(img, 0, 0, w, h);
                };
                img.src = item.data;
            }, 80);
        }

        function initPaint() {
            if (paintInitialized) return;
            const canvas = document.getElementById('paint-canvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            let drawing = false;
            let lastX = 0, lastY = 0;
            let brushType = 'normal';
            let eraser = false;

            const colorInput = document.getElementById('paint-color');
            const sizeInput = document.getElementById('paint-size');
            const btnNormal = document.getElementById('paint-brush-normal');
            const btnSoft = document.getElementById('paint-brush-soft');
            const btnEraser = document.getElementById('paint-eraser');
            const btnFill = document.getElementById('paint-fill');
            const btnClear = document.getElementById('paint-clear');
            const btnSave = document.getElementById('paint-save');

            function setBrushSettings() {
                ctx.lineJoin = 'round';
                ctx.lineCap = 'round';
                ctx.lineWidth = parseInt(sizeInput.value, 10) || 6;
                ctx.globalCompositeOperation = eraser ? 'destination-out' : 'source-over';
                ctx.strokeStyle = colorInput.value || '#—Å—Å—Å';
                if (brushType === 'soft' && !eraser) {
                    ctx.shadowColor = ctx.strokeStyle;
                    ctx.shadowBlur = Math.max(1, ctx.lineWidth * 0.9);
                } else {
                    ctx.shadowBlur = 0;
                }
            }

            function pointerDown(e) {
                // —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∏—Å–æ–≤–∞–Ω–∏—è
                pushPaintState();
                drawing = true;
                const rect = canvas.getBoundingClientRect();
                lastX = (e.clientX || e.touches && e.touches[0].clientX) - rect.left;
                lastY = (e.clientY || e.touches && e.touches[0].clientY) - rect.top;
                setBrushSettings();
                ctx.beginPath();
                ctx.moveTo(lastX, lastY);
            }

            function pointerMove(e) {
                if (!drawing) return;
                const rect = canvas.getBoundingClientRect();
                const x = (e.clientX || e.touches && e.touches[0].clientX) - rect.left;
                const y = (e.clientY || e.touches && e.touches[0].clientY) - rect.top;
                ctx.lineTo(x, y);
                ctx.stroke();
                lastX = x; lastY = y;
            }

            function pointerUp() { drawing = false; ctx.closePath(); }

            canvas.addEventListener('pointerdown', pointerDown);
            canvas.addEventListener('pointermove', pointerMove);
            canvas.addEventListener('pointerup', pointerUp);
            canvas.addEventListener('pointerleave', pointerUp);

            // toolbar
            btnNormal.addEventListener('click', function () { brushType = 'normal'; btnNormal.classList.add('active'); btnSoft.classList.remove('active'); eraser = false; btnEraser.classList.remove('active'); });
            btnSoft.addEventListener('click', function () { brushType = 'soft'; btnSoft.classList.add('active'); btnNormal.classList.remove('active'); eraser = false; btnEraser.classList.remove('active'); });
            btnEraser.addEventListener('click', function () { eraser = !eraser; btnEraser.classList.toggle('active'); });
            btnFill.addEventListener('click', function () { pushPaintState(); ctx.save(); ctx.globalCompositeOperation = 'source-over'; ctx.fillStyle = colorInput.value || '#ffffff'; ctx.fillRect(0, 0, canvas.width, canvas.height); ctx.restore(); updatePaintUndoRedoButtons(); });
            btnClear.addEventListener('click', function () { const ok = confirm('–û—á–∏—Å—Ç–∏—Ç—å —Ö–æ–ª—Å—Ç?'); if (!ok) return; pushPaintState(); ctx.clearRect(0, 0, canvas.width, canvas.height); updatePaintUndoRedoButtons(); });
            btnSave.addEventListener('click', function () { savePaintToVFS(); });

            const btnUndo = document.getElementById('paint-undo');
            const btnRedo = document.getElementById('paint-redo');
            if (btnUndo) btnUndo.addEventListener('click', undoPaint);
            if (btnRedo) btnRedo.addEventListener('click', redoPaint);

            // keyboard shortcuts for active paint window
            document.addEventListener('keydown', function (e) {
                const pw = document.getElementById('paint-window');
                if (!pw || !pw.classList.contains('active')) return;
                const key = e.key || e.keyCode;
                if ((e.ctrlKey || e.metaKey) && !e.shiftKey && (key === 'z' || key === 'Z')) {
                    e.preventDefault(); undoPaint();
                } else if ((e.ctrlKey || e.metaKey) && ((key === 'y' || key === 'Y') || (e.shiftKey && (key === 'Z' || key === 'z')))) {
                    e.preventDefault(); redoPaint();
                }
            });

            // –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä –∫–∏—Å—Ç–∏/color —Ä–µ—Ñ—Ä–µ—à
            sizeInput.addEventListener('input', setBrushSettings);
            colorInput.addEventListener('input', setBrushSettings);

            // –ò–Ω–∏—Ü–∏–∞–ª–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
            setBrushSettings();
            paintInitialized = true;
        }

        function savePaintToVFS() {
            const canvas = document.getElementById('paint-canvas');
            if (!canvas) return;
            const data = canvas.toDataURL('image/png');
            const pics = getNodeByPath(['Pictures']) || vfs.children['Pictures'];
            if (!pics.children) pics.children = {};
            const defaultName = `drawing-${(new Date()).toISOString().replaceAll(':', '').replaceAll('.', '')}.png`;
            const name = prompt('–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ (–∏–º—è —Ñ–∞–π–ª–∞):', defaultName);
            if (!name) return;
            pics.children[name] = { type: 'image', data };
            showNotification('–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ Pictures');
            // –µ—Å–ª–∏ —Å–µ–π—á–∞—Å —Å–º–æ—Ç—Ä–∏–º Pictures ‚Äî –æ–±–Ω–æ–≤–∏–º —Å–ø–∏—Å–æ–∫
            if ((currentPath.length === 1 && currentPath[0] === 'Pictures') || currentPath.length === 0) renderCurrentFolder();
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞
        function showTerminal() {
            openApp('terminal');
        }

        // –û—Ç–∫—Ä—ã—Ç—å –±–ª–æ–∫–Ω–æ—Ç (–∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å —Ñ–∞–π–ª–æ–≤—ã–º –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º)
        function openNotepad() {
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω–æ–µ –æ–∫–Ω–æ –±–ª–æ–∫–Ω–æ—Ç–∞
            editingFile = null;
            document.getElementById('editor-filename').textContent = '–ù–æ–≤—ã–π —Ñ–∞–π–ª.txt';
            const ta = document.getElementById('editor-text');
            if (ta) ta.value = '';
            openApp('notepad');
            setTimeout(() => { if (ta) { ta.focus(); ta.selectionStart = ta.value.length; } }, 50);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª
        function setupDesktopClick() {
            document.querySelector('.desktop').addEventListener('click', function (e) {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–ª–∏–∫–Ω—É–ª–∏ –∏–º–µ–Ω–Ω–æ –Ω–∞ —Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª, –∞ –Ω–µ –Ω–∞ –∏–∫–æ–Ω–∫–∏
                if (e.target.classList.contains('desktop') ||
                    e.target.classList.contains('desktop-icon') ||
                    e.target.closest('.desktop-icon')) {
                    return; // –ù–µ —Å–∫—Ä—ã–≤–∞–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∏–∫–æ–Ω–∫–∏
                }
                const terminal = document.querySelector('.terminal');
                terminal.style.display = 'none';
            });
        }

        // –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä: –ø—Ä–æ—Å—Ç–∞—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
        function initCalculator() {
            const display = document.getElementById('calc-display');
            if (!display) return;

            function appendToDisplay(v) {
                if (display.value === '–û—à–∏–±–∫–∞') display.value = '';
                display.value = (display.value || '') + v;
            }

            function clearDisplay() { display.value = ''; }
            function backspace() { display.value = display.value.slice(0, -1); }

            function formatForEval(expr) {
                return expr.replace(/√ó/g, '*').replace(/√∑/g, '/').replace(/‚àí/g, '-');
            }

            function evaluateExpression() {
                try {
                    const expr = formatForEval(display.value || '0');
                    if (!/^[0-9.+\-*/()%\s]+$/.test(expr)) { display.value = '–û—à–∏–±–∫–∞'; return; }
                    // eslint-disable-next-line no-new-func
                    const result = Function('return ' + expr)();
                    display.value = String(result);
                } catch (e) { display.value = '–û—à–∏–±–∫–∞'; }
            }

            document.querySelectorAll('#calc .button').forEach(btn => {
                btn.addEventListener('click', function () {
                    const cmd = this.getAttribute('data-cmd');
                    if (!cmd) return;
                    if (cmd === 'clear') clearDisplay();
                    else if (cmd === 'back') backspace();
                    else if (cmd === '=') evaluateExpression();
                    else appendToDisplay(cmd);
                });
            });

            window.addEventListener('keydown', function (e) {
                const key = e.key;
                const active = document.activeElement;
                const activeTag = active ? active.tagName : null;

                // –ï—Å–ª–∏ —Ñ–æ–∫—É—Å –≤ –æ–±—ã—á–Ω–æ–º —Ç–µ–∫—Å—Ç–æ–≤–æ–º –ø–æ–ª–µ/textarea ‚Äî –Ω–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º Enter/Backspace
                if (key === 'Enter') {
                    if (activeTag === 'TEXTAREA') return; // —Ä–∞–∑—Ä–µ—à–∞–µ–º –ø–µ—Ä–µ–Ω–æ—Å —Å—Ç—Ä–æ–∫–∏ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
                    e.preventDefault(); evaluateExpression(); return;
                }

                if (key === 'Backspace') {
                    if (activeTag === 'INPUT' || activeTag === 'TEXTAREA') return; // –ø–æ–∑–≤–æ–ª—è–µ–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—è
                    e.preventDefault(); backspace(); return;
                }

                if (key === 'Escape') {
                    if (activeTag === 'TEXTAREA' || activeTag === 'INPUT') return;
                    e.preventDefault(); clearDisplay(); return;
                }

                // –ß–∏—Å–ª–∞ –∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã ‚Äî –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –µ—Å–ª–∏ —Ñ–æ–∫—É—Å –≤ –ø–æ–ª—è—Ö –≤–≤–æ–¥–∞
                if (/^[0-9.+\-*/()%]$/.test(key)) {
                    if (activeTag === 'INPUT' || activeTag === 'TEXTAREA') return;
                    appendToDisplay(key);
                }
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function () {
            showNotification('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ BlumbOS!');
            showAsciiLogo();
            setupDesktopClick();

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –±—Ä–∞—É–∑–µ—Ä UI
            updateBrowserUI();

            // –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ close/minimize –≤–æ –≤—Å–µ—Ö –æ–∫–Ω–∞—Ö
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –≤ app-window (.window-close)
            document.querySelectorAll('.window-close').forEach(btn => {
                btn.addEventListener('click', function (e) {
                    e.stopPropagation();
                    // –ù–∞—Ö–æ–¥–∏–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–µ –æ–∫–Ω–æ
                    const appWindow = this.closest('.app-window');
                    if (!appWindow) return;
                    const appId = appWindow.id; // e.g., 'files-window'
                    const appName = appId.replace('-window', ''); // e.g., 'files'
                    // –£–¥–∞–ª—è–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                    if (windowStates[appName]) delete windowStates[appName];
                    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º inline-—Å—Ç–∏–ª–∏ –∫ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º
                    appWindow.style.left = '50%';
                    appWindow.style.top = '50%';
                    appWindow.style.transform = 'translate(-50%, -50%)';
                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã (–µ—Å–ª–∏ –±—ã–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã)
                    appWindow.style.width = '';
                    appWindow.style.height = '';
                    appWindow.style.display = 'none';
                    closeApp(appName);
                });
            });
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –≤ app-window (.window-minimize)
            document.querySelectorAll('.window-minimize').forEach(btn => {
                btn.addEventListener('click', function (e) {
                    e.stopPropagation();
                    const appWindow = this.closest('.app-window');
                    if (!appWindow) return;
                    const appId = appWindow.id;
                    const appName = appId.replace('-window', '');
                    // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏ —Ä–∞–∑–º–µ—Ä –≤ –ø–∏–∫—Å–µ–ª—è—Ö
                    const rect = appWindow.getBoundingClientRect();
                    const parent = appWindow.offsetParent ? appWindow.offsetParent.getBoundingClientRect() : { left: 0, top: 0 };
                    const leftPx = (rect.left - parent.left) + 'px';
                    const topPx = (rect.top - parent.top) + 'px';
                    const widthPx = rect.width + 'px';
                    const heightPx = rect.height + 'px';
                    windowStates[appName] = { left: leftPx, top: topPx, width: widthPx, height: heightPx };
                    minimizeApp(appName);
                });
            });
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ (.terminal-button)
            const terminalButtons = document.querySelectorAll('.terminal-button');
            if (terminalButtons.length > 0) {
                terminalButtons[0].addEventListener('click', function (e) { // close
                    e.stopPropagation();
                    const term = document.getElementById('terminal-window') || document.querySelector('.terminal');
                    if (windowStates['terminal']) delete windowStates['terminal'];
                    term.style.left = '50%';
                    term.style.top = '50%';
                    term.style.transform = 'translate(-50%, -50%)';
                    term.style.width = '600px';
                    term.style.height = '400px';
                    term.style.display = 'none';
                });
                if (terminalButtons.length > 1) {
                    terminalButtons[1].addEventListener('click', function (e) { // minimize
                        e.stopPropagation();
                        const term = document.getElementById('terminal-window') || document.querySelector('.terminal');
                        const rect = term.getBoundingClientRect();
                        const parent = term.offsetParent ? term.offsetParent.getBoundingClientRect() : { left: 0, top: 0 };
                        const leftPx = (rect.left - parent.left) + 'px';
                        const topPx = (rect.top - parent.top) + 'px';
                        const widthPx = rect.width + 'px';
                        const heightPx = rect.height + 'px';
                        windowStates['terminal'] = { left: leftPx, top: topPx, width: widthPx, height: heightPx };
                        term.style.display = 'none';
                    });
                }
                if (terminalButtons.length > 2) {
                    terminalButtons[2].addEventListener('click', function (e) { // maximize
                        e.stopPropagation();
                        const terminal = document.getElementById('terminal-window') || document.querySelector('.terminal');
                        if (terminal.style.width === 'calc(100% - 40px)') {
                            terminal.style.width = '600px';
                            terminal.style.height = '400px';
                            terminal.style.transform = 'translate(-50%, -50%)';
                        } else {
                            terminal.style.width = 'calc(100% - 40px)';
                            terminal.style.height = 'calc(100% - 80px)';
                            terminal.style.transform = 'translate(-50%, -50%)';
                        }
                    });
                }
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ UI
            const btnNewFolder = document.getElementById('btn-new-folder');
            const btnNewFile = document.getElementById('btn-new-file');
            const btnUp = document.getElementById('btn-up');
            const editorSave = document.getElementById('editor-save');
            const editorClose = document.getElementById('editor-close');

            if (btnNewFolder) btnNewFolder.addEventListener('click', createFolder);
            if (btnNewFile) btnNewFile.addEventListener('click', createTextFile);
            if (btnUp) btnUp.addEventListener('click', goUp);
            if (editorSave) editorSave.addEventListener('click', saveEditor);
            if (editorClose) editorClose.addEventListener('click', closeEditor);

            // –†–µ–Ω–¥–µ—Ä–∏–º –¥–æ–º–∞—à–Ω—é—é –ø–∞–ø–∫—É (—Å–∫—Ä—ã—Ç–æ–µ –æ–∫–Ω–æ ‚Äî —Ä–µ–Ω–¥–µ—Ä –Ω–µ –≤–∏–¥–µ–Ω, –Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞)
            renderCurrentFolder();
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
            initCalculator();
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Paint (–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)
            try { initPaint(); } catch (e) { /* ignore until paint opened */ }
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Paint
            try { initPaint(); } catch (e) { console.error('initPaint error', e); }

            // –ó–∞–∫—Ä—ã–≤–∞—Ç—å –ª—é–±—ã–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ
            document.addEventListener('click', function () {
                document.querySelectorAll('.file-menu').forEach(m => m.style.display = 'none');
            });

            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ, –±–µ—Ä—ë–º –∑–Ω–∞—á–µ–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–∞ —Ç–µ–º—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
            try {
                const themeSelect = document.querySelector('select[onchange^="changeTheme"]');
                const initialTheme = themeSelect ? (themeSelect.value || 'orange') : 'orange';
                // –í—ã–∑—ã–≤–∞–µ–º changeTheme –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ—Ö —Å—Ç–∏–ª–µ–π —Å—Ä–∞–∑—É
                if (typeof changeTheme === 'function') {
                    changeTheme(initialTheme, true);
                }
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –Ω–∞—á–∞–ª—å–Ω–æ–π —Ç–µ–º—ã:', e);
            }

            // === Drag & Resize: —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–æ–Ω ===
            // –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã —Å –∫–ª–∞—Å—Å–∞–º–∏ .app-window –∏ .terminal
            function makeWindowsDraggableResizable() {
                const windows = document.querySelectorAll('.app-window, .terminal');
                windows.forEach(win => {
                    // –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ.
                    // –ï—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ transform (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–µ—Ä–º–∏–Ω–∞–ª),
                    // –≤—ã—á–∏—Å–ª—è–µ–º —Ç–µ–∫—É—â–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏ –ø–µ—Ä–µ–≤–æ–¥–∏–º –≤ left/top, —É–±–∏—Ä–∞—è transform,
                    // —á—Ç–æ–±—ã –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ –Ω–µ –≤—ã—á–∏—Å–ª—è–ª–∏—Å—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.
                    const cs = getComputedStyle(win);
                    const rect = win.getBoundingClientRect();
                    const hasTransform = cs.transform && cs.transform !== 'none';
                    if (hasTransform) {
                        const computedLeft = rect.left + window.scrollX;
                        const computedTop = rect.top + window.scrollY;
                        win.style.left = computedLeft + 'px';
                        win.style.top = computedTop + 'px';
                        // –£–±–∏—Ä–∞–µ–º transform (—Ü–µ–Ω—Ç—Ä–æ–≤–∫–∞ –±—ã–ª–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è)
                        win.style.transform = 'none';
                    } else {
                        // –ï—Å–ª–∏ inline-—Å—Ç–∏–ª—è left/top –Ω–µ—Ç, —É—Å—Ç–∞–Ω–æ–≤–∏–º –∏—Ö, —á—Ç–æ–±—ã –¥–∞–ª—å–Ω–µ–π—à–∏–µ —Ä–∞—Å—á—ë—Ç—ã –±—ã–ª–∏ —Ç–æ—á–Ω—ã–º–∏
                        if (!win.style.left) win.style.left = rect.left + 'px';
                        if (!win.style.top) win.style.top = rect.top + 'px';
                    }
                    win.style.position = 'absolute';
                    win.style.touchAction = 'none';

                    const header = win.querySelector('.window-header, .terminal-header');
                    if (header) {
                        header.style.cursor = 'move';
                        header.onpointerdown = null;
                        header.addEventListener('pointerdown', startDrag);
                    }

                    // –ü—Ä–∏ –ª—é–±–æ–º –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –æ–∫–Ω–æ —Å—Ç–∞–≤–∏–º –µ–≥–æ –Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏–π –ø–ª–∞–Ω
                    win.addEventListener('pointerdown', function (e) {
                        // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –∫–ª–∏–∫–∏ –ø–æ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º —ç–ª–µ–º–µ–Ω—Ç–∞–º
                        if (e.target && e.target.closest && e.target.closest('.terminal-buttons, .window-buttons, .terminal-button, .window-button, button, input, select, textarea')) {
                            return;
                        }
                        makeWindowsDraggableResizable.zIndex = (makeWindowsDraggableResizable.zIndex || 200) + 1;
                        this.style.zIndex = makeWindowsDraggableResizable.zIndex;
                    });

                    const handles = win.querySelectorAll('.resize-handle');
                    handles.forEach(h => {
                        h.style.touchAction = 'none';
                        h.onpointerdown = null;
                        h.addEventListener('pointerdown', startResize);
                    });
                });

                let activeWin = null;
                let startX = 0, startY = 0;
                let startW = 0, startH = 0;
                let startLeft = 0, startTop = 0;
                let pointerOffsetX = 0, pointerOffsetY = 0;
                let action = null; // 'move' | 'resize-br' | 'resize-r' | 'resize-b' | 'resize'

                function startDrag(e) {
                    // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –∑–∞—Ö–≤–∞—Ç, –µ—Å–ª–∏ –∫–ª–∏–∫ –Ω–∞—á–∞–ª—Å—è –ø–æ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –≤–Ω—É—Ç—Ä–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞
                    if (e.target && e.target.closest && e.target.closest('.terminal-buttons, .window-buttons, .terminal-button, .window-button, button, input, select, textarea')) {
                        return; // –ø–æ–∑–≤–æ–ª—è–µ–º —Å–æ–±—ã—Ç–∏—é –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –∫–ª–∏–∫
                    }
                    if (e.button && e.button !== 0) return;
                    activeWin = this.closest('.app-window, .terminal');
                    if (!activeWin) return;
                    action = 'move';
                    try { activeWin.setPointerCapture(e.pointerId); } catch (err) { }

                    const rect = activeWin.getBoundingClientRect();
                    // –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –ø–µ—Ä–µ–≤–æ–¥–∏–º —Ç–µ–∫—É—â—É—é –≤–∏–∑—É–∞–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –≤ left/top
                    startX = e.clientX; startY = e.clientY;
                    startLeft = rect.left + window.scrollX; startTop = rect.top + window.scrollY;
                    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ left/top –∏ —É–±–∏—Ä–∞–µ–º transform (–µ—Å–ª–∏ –≤–¥—Ä—É–≥ –æ—Å—Ç–∞–ª—Å—è)
                    activeWin.style.left = startLeft + 'px';
                    activeWin.style.top = startTop + 'px';
                    activeWin.style.transform = 'none';
                    // –°–º–µ—â–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –≤–Ω—É—Ç—Ä–∏ –æ–∫–Ω–∞ ‚Äî —á—Ç–æ–±—ã –æ–∫–Ω–æ –Ω–µ ¬´–ø—Ä—ã–≥–∞–ª–æ¬ª –ø—Ä–∏ –∑–∞—Ö–≤–∞—Ç–µ
                    pointerOffsetX = startX - startLeft;
                    pointerOffsetY = startY - startTop;

                    makeWindowsDraggableResizable.zIndex = (makeWindowsDraggableResizable.zIndex || 200) + 1;
                    activeWin.style.zIndex = makeWindowsDraggableResizable.zIndex;

                    document.addEventListener('pointermove', onPointerMove);
                    document.addEventListener('pointerup', endPointer);
                    document.addEventListener('pointercancel', endPointer);
                    window.addEventListener('blur', endPointer);
                }

                function startResize(e) {
                    if (e.button && e.button !== 0) return;
                    activeWin = this.closest('.app-window, .terminal');
                    if (!activeWin) return;
                    e.preventDefault();

                    if (this.classList.contains('resize-handle-bottom-right')) action = 'resize-br';
                    else if (this.classList.contains('resize-handle-right')) action = 'resize-r';
                    else if (this.classList.contains('resize-handle-bottom')) action = 'resize-b';
                    else if (this.classList.contains('resize-handle-left')) action = 'resize-l';
                    else if (this.classList.contains('resize-handle-top')) action = 'resize-t'; // NEW
                    else if (this.classList.contains('resize-handle-top-left')) action = 'resize-tl'; // NEW
                    else if (this.classList.contains('resize-handle-top-right')) action = 'resize-tr'; // NEW
                    else action = 'resize';

                    try { activeWin.setPointerCapture(e.pointerId); } catch (err) { }
                    const rect = activeWin.getBoundingClientRect();
                    startX = e.clientX; startY = e.clientY;
                    startW = rect.width; startH = rect.height;
                    startLeft = rect.left + window.scrollX; startTop = rect.top + window.scrollY;

                    makeWindowsDraggableResizable.zIndex = (makeWindowsDraggableResizable.zIndex || 200) + 1;
                    activeWin.style.zIndex = makeWindowsDraggableResizable.zIndex;

                    document.addEventListener('pointermove', onPointerMove);
                    document.addEventListener('pointerup', endPointer);
                }

                function onPointerMove(e) {
                    if (!activeWin) return;
                    e.preventDefault();

                    const cs = getComputedStyle(activeWin);
                    const minW = parseInt(cs.minWidth) || 200;
                    const minH = parseInt(cs.minHeight) || 150;

                    if (action === 'move') {
                        // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–º–µ—â–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
                        let left = e.clientX - pointerOffsetX;
                        let top = e.clientY - pointerOffsetY;
                        left = Math.max(0, Math.min(left, window.innerWidth - activeWin.offsetWidth));
                        top = Math.max(0, Math.min(top, window.innerHeight - activeWin.offsetHeight - 40));
                        activeWin.style.left = left + 'px';
                        activeWin.style.top = top + 'px';
                    } else if (action && action.startsWith('resize')) {
                        const dx = e.clientX - startX;
                        const dy = e.clientY - startY;
                        let newW = startW;
                        let newH = startH;

                        // –õ–æ–≥–∏–∫–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
                        // 1. –ò–∑–º–µ–Ω–µ–Ω–∏–µ —à–∏—Ä–∏–Ω—ã (Right)
                        if (['resize-r', 'resize-br', 'resize-tr'].includes(action)) {
                            newW = Math.max(minW, startW + dx);
                            activeWin.style.width = newW + 'px';
                        }

                        // 2. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã (Bottom)
                        if (['resize-b', 'resize-br', 'resize-bl'].includes(action)) {
                            newH = Math.max(minH, startH + dy);
                            activeWin.style.height = newH + 'px';
                        }

                        // 3. –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–ª–µ–≤–∞ (Left) - –º–µ–Ω—è–µ–º width –∏ left
                        if (['resize-l', 'resize-tl', 'resize-bl'].includes(action)) {
                            const proposedW = Math.max(minW, startW - dx);
                            // –ï—Å–ª–∏ —à–∏—Ä–∏–Ω–∞ –¥–æ—Å—Ç–∏–≥–ª–∞ –º–∏–Ω–∏–º—É–º–∞, –ø—Ä–µ–∫—Ä–∞—â–∞–µ–º —Å–¥–≤–∏–≥ left
                            if (proposedW > minW) {
                                const newLeft = startLeft + (startW - proposedW);
                                activeWin.style.width = proposedW + 'px';
                                activeWin.style.left = newLeft + 'px';
                            }
                        }

                        // 4. –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–≤–µ—Ä—Ö—É (Top) - –º–µ–Ω—è–µ–º height –∏ top
                        if (['resize-t', 'resize-tl', 'resize-tr'].includes(action)) {
                            const proposedH = Math.max(minH, startH - dy);
                            // –ï—Å–ª–∏ –≤—ã—Å–æ—Ç–∞ –¥–æ—Å—Ç–∏–≥–ª–∞ –º–∏–Ω–∏–º—É–º–∞, –ø—Ä–µ–∫—Ä–∞—â–∞–µ–º —Å–¥–≤–∏–≥ top
                            if (proposedH > minH) {
                                const newTop = startTop + (startH - proposedH);
                                activeWin.style.height = proposedH + 'px';
                                activeWin.style.top = newTop + 'px';
                            }
                        }
                    }
                }

                function endPointer(e) {
                    try { if (activeWin) activeWin.releasePointerCapture(e.pointerId); } catch (err) { }
                    document.removeEventListener('pointermove', onPointerMove);
                    document.removeEventListener('pointerup', endPointer);
                    activeWin = null; action = null;
                }
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º drag&resize –¥–ª—è —Ç–µ–∫—É—â–∏—Ö –æ–∫–æ–Ω
            makeWindowsDraggableResizable();

        });
    </script>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Å—Ç–æ–≥–æ –≤–∏–¥–µ–æ–ø–ª–µ–µ—Ä–∞: –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞, URL, —Å–∫–∞–Ω –∫–∞—Ç–∞–ª–æ–≥–∞ ./video
        document.addEventListener('DOMContentLoaded', function () {
            const player = document.getElementById('video-player');
            if (!player) return;

            const fileInput = document.getElementById('video-file-input');
            const urlInput = document.getElementById('video-url-input');
            const loadBtn = document.getElementById('video-load-url-btn');
            const scanBtn = document.getElementById('video-scan-btn');
            const playlist = document.getElementById('video-playlist');

            function addToPlaylist(name, src) {
                if (!playlist) return;
                // –∏–∑–±–µ–≥–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
                for (const li of playlist.querySelectorAll('li')) {
                    if (li.dataset && li.dataset.src === src) return;
                }
                const li = document.createElement('li');
                li.textContent = name;
                li.style.padding = '6px';
                li.style.cursor = 'pointer';
                li.dataset.src = src;
                li.onclick = function () {
                    player.src = src;
                    player.play();
                };
                playlist.appendChild(li);
            }

            if (fileInput) {
                fileInput.addEventListener('change', function (e) {
                    const f = e.target.files && e.target.files[0];
                    if (!f) return;
                    const src = URL.createObjectURL(f);
                    addToPlaylist(f.name, src);
                    player.src = src;
                    player.play();
                });
            }

            if (loadBtn) {
                loadBtn.addEventListener('click', function () {
                    const url = (urlInput && urlInput.value || '').trim();
                    if (!url) { showNotification('–í–≤–µ–¥–∏—Ç–µ URL –∏–ª–∏ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É'); return; }
                    addToPlaylist(url, url);
                    player.src = url;
                    player.play();
                });
            }

            if (scanBtn) {
                scanBtn.addEventListener('click', function () {
                    // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –∏–Ω–¥–µ–∫—Å –∫–∞—Ç–∞–ª–æ–≥–∞ ./video/ –∏ –Ω–∞–π—Ç–∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ –≤–∏–¥–µ–æ—Ñ–∞–π–ª—ã
                    fetch('./video/').then(r => r.text()).then(html => {
                        const tmp = document.createElement('div');
                        tmp.innerHTML = html;
                        const links = tmp.querySelectorAll('a');
                        const exts = ['.mp4', '.webm', '.ogg', '.mov', '.m4v'];
                        let found = false;
                        links.forEach(a => {
                            const href = a.getAttribute('href');
                            if (!href) return;
                            const low = href.toLowerCase();
                            if (exts.some(e => low.endsWith(e))) {
                                const src = href.startsWith('http') || href.startsWith('/') ? href : ('./video/' + href);
                                addToPlaylist(href, src);
                                found = true;
                            }
                        });
                        if (!found) showNotification('–ù–µ –Ω–∞–π–¥–µ–Ω–æ –≤–∏–¥–µ–æ –≤ ./video –∏–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–¥–∞—ë—Ç —Å–ø–∏—Å–æ–∫.');
                    }).catch(err => {
                        showNotification('–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ ./video –Ω–µ —É–¥–∞–ª–æ—Å—å');
                    });
                });
            }

            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–≤–∏–º –Ω–∞ –ø–∞—É–∑—É, –µ—Å–ª–∏ –æ–∫–Ω–æ —Å–∫—Ä—ã—Ç–æ
            setInterval(function () {
                const win = document.getElementById('video-window');
                if (!win) return;
                if (!win.classList.contains('active') && !player.paused) {
                    player.pause();
                }
            }, 700);
        });
    </script>
</body>

</html>